<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Vehicle Transport - Harihar Car Carriers</title>
     <base href="./" />
  <link rel="icon" type="image/png" href="../assets/icons/favicon.png" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Navbar CSS -->
    <link rel="stylesheet" href="../css/components/navbar.css">
    <link rel="stylesheet" href="../css/components/middle-navbar.css">
    <!-- Loading Indicators CSS -->
    <link rel="stylesheet" href="../css/components/loading-indicators.css">
    <link rel="stylesheet" href="../css/styles.css">

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />

    <!-- Leaflet Routing Machine CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.css" />

    <!-- Leaflet Control Geocoder CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder@2.4.0/dist/Control.Geocoder.css" />

    <!-- Leaflet Plugins for Advanced Features -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />

    <!-- Booking CSS -->
    <link rel="stylesheet" href="../css/components/booking.css">

    <!-- Booking Modals CSS -->
    <link rel="stylesheet" href="../css/components/booking-modals.css">
    <link rel="stylesheet" href="../css/pages/booking.css">

    <!-- Lottie Animation -->
    <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
    <link rel="stylesheet" href="../css/components/glowing-input.css">
    <link rel="stylesheet" href="../css/pages/booking.css">

    
</head>

<body>
    <!-- Navbar Component -->
    <div id="navbar-container"></div>
    <!-- Loading State Manager - Must load first -->
    <script src="../js/modules/loading-state-manager.js"></script>
    <!-- Page Navigation Loader - Must load after loading-state-manager -->
    <script src="../js/modules/page-navigation-loader.js"></script>
    <script src="../js/modules/navbar-loader.js?v=2"></script>

    <!-- Hero Section -->
    <section class="booking-hero">
        <div class="container">
            <h1 class="fade-in">Book Your Vehicle Transport</h1>
            <p class="fade-in">Quick, secure, and reliable vehicle transportation booking with interactive map</p>
        </div>
    </section>

    <!-- Booking Section -->
    <section class="booking-section">
        <div class="container">
            <div class="booking-container">
                <!-- Booking Form -->
                <div class="booking-form-container fade-in">
                    <!-- Progress Bar -->
                    <div class="progress-container">
                        <div class="progress-steps">
                            <div class="progress-line">
                                <div class="progress-line-fill" id="progressFill"></div>
                            </div>
                            <div class="step active" data-step="1">
                                <div class="step-circle">
                                    <span class="step-number">1</span>
                                    <i class="fas fa-check"></i>
                                </div>
                                <div class="step-label">Details</div>
                            </div>
                            <div class="step" data-step="2">
                                <div class="step-circle">
                                    <span class="step-number">2</span>
                                    <i class="fas fa-check"></i>
                                </div>
                                <div class="step-label">Review</div>
                            </div>
                            <div class="step" data-step="3">
                                <div class="step-circle">
                                    <span class="step-number">3</span>
                                    <i class="fas fa-check"></i>
                                </div>
                                <div class="step-label">Confirm</div>
                            </div>
                        </div>
                        <div class="progress-percentage" id="progressPercentage">33% Complete</div>
                    </div>

                    <form class="booking-form" id="autoSaveForm">
                        <!-- Step 1: Personal & Vehicle Details -->
                        <div class="form-step active" data-step="1">
                            <div class="step-header">
                                <h3><i class="fas fa-user-circle"></i> Personal & Vehicle Information</h3>
                                <p>Tell us about yourself and your vehicle</p>
                            </div>

                            <!-- Personal Information -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="fullName"><i class="fas fa-user"></i> Full Name *</label>
                                    <input type="text" id="fullName" name="fullName" required
                                        placeholder="Enter your full name">
                                    <span class="validation-icon"><i class="fas fa-check-circle"></i></span>
                                    <div class="error-message" id="nameError">Please enter your full name</div>
                                </div>
                                <div class="form-group">
                                    <label for="phone"><i class="fas fa-phone"></i> Phone Number *</label>
                                    <input type="tel" id="phone" name="phone" required
                                        placeholder="Enter 10-digit number">
                                    <span class="validation-icon"><i class="fas fa-check-circle"></i></span>
                                    <div class="error-message" id="phoneError">Please enter a valid 10-digit phone
                                        number</div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="email"><i class="fas fa-envelope"></i> Email Address *</label>
                                <input type="email" id="email" name="email" required placeholder="Enter your email">
                                <span class="validation-icon"><i class="fas fa-check-circle"></i></span>
                                <div class="error-message" id="emailError">Please enter a valid email address</div>
                            </div>

                            <!-- Vehicle Information -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="vehicleType"><i class="fas fa-car"></i> Vehicle Type *</label>
                                    <select id="vehicleType" name="vehicleType" required>
                                        <option value="">Select Vehicle Type</option>
                                        <option value="hatchback">Hatchback</option>
                                        <option value="sedan">Sedan</option>
                                        <option value="suv">SUV</option>
                                        <option value="luxury">Luxury Car</option>
                                        <option value="bike">Motorcycle</option>
                                        <option value="commercial">Commercial Vehicle</option>
                                    </select>
                                    <span class="validation-icon"><i class="fas fa-check-circle"></i></span>
                                    <div class="error-message" id="vehicleError">Please select vehicle type</div>
                                </div>
                                <div class="form-group">
                                    <label for="vehicleModel"><i class="fas fa-cog"></i> Vehicle Model</label>
                                    <input type="text" id="vehicleModel" name="vehicleModel"
                                        placeholder="e.g., Hyundai Creta">
                                </div>
                            </div>

                            <!-- Add-on Services -->
                            <div class="addon-services">
                                <h4><i class="fas fa-plus-circle"></i> Add-on Services (Optional)</h4>
                                <div class="addon-grid">
                                    <div class="addon-item" onclick="toggleAddon(this, 'cleaning', 500)">
                                        <input type="checkbox" class="addon-checkbox" id="addonCleaning" name="addons"
                                            value="cleaning">
                                        <i class="fas fa-spray-can addon-icon"></i>
                                        <div class="addon-info">
                                            <div class="addon-name">Interior Cleaning</div>
                                            <div class="addon-desc">Deep cleaning of vehicle interior</div>
                                        </div>
                                        <div class="addon-price">â‚¹500</div>
                                    </div>
                                    <div class="addon-item" onclick="toggleAddon(this, 'detailing', 1500)">
                                        <input type="checkbox" class="addon-checkbox" id="addonDetailing" name="addons"
                                            value="detailing">
                                        <i class="fas fa-star addon-icon"></i>
                                        <div class="addon-info">
                                            <div class="addon-name">Premium Detailing</div>
                                            <div class="addon-desc">Complete exterior & interior detailing</div>
                                        </div>
                                        <div class="addon-price">â‚¹1,500</div>
                                    </div>
                                    <div class="addon-item" onclick="toggleAddon(this, 'insurance', 800)">
                                        <input type="checkbox" class="addon-checkbox" id="addonInsurance" name="addons"
                                            value="insurance">
                                        <i class="fas fa-shield-alt addon-icon"></i>
                                        <div class="addon-info">
                                            <div class="addon-name">Extra Insurance</div>
                                            <div class="addon-desc">Additional coverage up to â‚¹5 lakhs</div>
                                        </div>
                                        <div class="addon-price">â‚¹800</div>
                                    </div>
                                    <div class="addon-item" onclick="toggleAddon(this, 'express', 2000)">
                                        <input type="checkbox" class="addon-checkbox" id="addonExpress" name="addons"
                                            value="express">
                                        <i class="fas fa-bolt addon-icon"></i>
                                        <div class="addon-info">
                                            <div class="addon-name">Express Delivery</div>
                                            <div class="addon-desc">Priority delivery - 30% faster</div>
                                        </div>
                                        <div class="addon-price">â‚¹2,000</div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-navigation">
                                <button type="button" class="booking-nav-btn booking-btn-prev" disabled>
                                    <i class="fas fa-arrow-left"></i> Previous
                                </button>
                                <button type="button" class="booking-nav-btn booking-btn-next" onclick="nextStep()">
                                    Next <i class="fas fa-arrow-right"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Step 2: Location & Schedule -->
                        <div class="form-step" data-step="2">
                            <div class="step-header">
                                <h3><i class="fas fa-map-marked-alt"></i> Location & Schedule</h3>
                                <p>Set your pickup and delivery details</p>
                            </div>

                            <!-- Location Information -->
                            <div class="form-group">
                                <label for="pickupCity"><i class="fas fa-map-marker-alt"></i> Pickup City *</label>
                                <div class="autocomplete-wrapper">
                                    <input type="text" id="pickupCity" name="pickupCity" required
                                        placeholder="Start typing city name..." autocomplete="off">
                                    <div class="autocomplete-dropdown" id="pickupCityDropdown"></div>
                                </div>
                                <span class="validation-icon"><i class="fas fa-check-circle"></i></span>
                                <div class="error-message" id="pickupError">Please select pickup city</div>
                            </div>

                            <div class="form-group">
                                <label for="dropCity"><i class="fas fa-flag-checkered"></i> Drop City *</label>
                                <div class="autocomplete-wrapper">
                                    <input type="text" id="dropCity" name="dropCity" required
                                        placeholder="Start typing city name..." autocomplete="off">
                                    <div class="autocomplete-dropdown" id="dropCityDropdown"></div>
                                </div>
                                <span class="validation-icon"><i class="fas fa-check-circle"></i></span>
                                <div class="error-message" id="dropError">Please select drop city</div>
                            </div>

                            <!-- Hidden fields for full addresses (optional) -->
                            <input type="hidden" id="pickupLocation" name="pickupLocation">
                            <input type="hidden" id="dropLocation" name="dropLocation">

                            <!-- Date & Time -->
                            <div class="date-time-row">
                                <div class="form-group">
                                    <label for="pickupDate"><i class="fas fa-calendar"></i> Preferred Pickup Date
                                        *</label>
                                    <input type="date" id="pickupDate" name="pickupDate" required>
                                    <span class="validation-icon"><i class="fas fa-check-circle"></i></span>
                                    <div class="error-message" id="dateError">Please select pickup date</div>
                                    <div class="date-warning" id="dateWarning"></div>
                                </div>
                                <div class="form-group">
                                    <label for="pickupTime"><i class="fas fa-clock"></i> Preferred Time</label>
                                    <select id="pickupTime" name="pickupTime">
                                        <option value="any">Any Time</option>
                                        <option value="morning">Morning (8 AM - 12 PM)</option>
                                        <option value="afternoon">Afternoon (12 PM - 5 PM)</option>
                                        <option value="evening">Evening (5 PM - 8 PM)</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Route Optimization with Waypoints -->
                            <div class="waypoints-section">
                                <div class="waypoints-header">
                                    <h4><i class="fas fa-map-signs"></i> Add Stops Along the Way</h4>
                                    <button type="button" class="add-waypoint-btn" onclick="addWaypoint()">
                                        <i class="fas fa-plus"></i> Add Stop
                                    </button>
                                </div>
                                <p style="color: #999; font-size: 0.9rem; margin-bottom: 15px;">
                                    Add intermediate stops for vehicle pickup or drop-off along your route
                                </p>
                                <div class="waypoints-list" id="waypointsList">
                                    <!-- Waypoints will be added dynamically -->
                                </div>
                                <button type="button" class="optimize-route-btn" id="optimizeRouteBtn"
                                    onclick="optimizeRoute()" style="display: none;">
                                    <i class="fas fa-route"></i> Optimize Route Order
                                </button>
                                <div class="optimization-result" id="optimizationResult">
                                    <h5><i class="fas fa-check-circle"></i> Route Optimized!</h5>
                                    <div class="optimization-stats">
                                        <div><i class="fas fa-road"></i> Distance Saved: <strong id="distanceSaved">0
                                                km</strong></div>
                                        <div><i class="fas fa-clock"></i> Time Saved: <strong id="timeSaved">0
                                                mins</strong></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Weather Forecast -->
                            <div class="weather-section" id="weatherSection" style="display: none;">
                                <div class="weather-header">
                                    <i class="fas fa-cloud-sun" style="font-size: 1.5rem;"></i>
                                    <h4>Weather Forecast</h4>
                                </div>
                                <div class="weather-grid" id="weatherGrid">
                                    <div class="weather-loading">
                                        <i class="fas fa-spinner fa-spin" style="font-size: 2rem; color: #ff6347;"></i>
                                        <p>Loading weather data...</p>
                                    </div>
                                </div>
                            </div>

                            <div class="form-navigation">
                                <button type="button" class="booking-nav-btn booking-btn-prev" onclick="prevStep()">
                                    <i class="fas fa-arrow-left"></i> Previous
                                </button>
                                <button type="button" class="save-later-btn" onclick="openSaveEmailModal()">
                                    <i class="fas fa-save"></i> Save & Continue Later
                                </button>
                                <button type="button" class="booking-nav-btn booking-btn-next" onclick="nextStep()">
                                    Next <i class="fas fa-arrow-right"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Step 3: Review & Confirm -->
                        <div class="form-step" data-step="3">
                            <div class="step-header">
                                <h3><i class="fas fa-clipboard-check"></i> Review & Confirm</h3>
                                <p>Verify your booking details before confirmation</p>
                            </div>

                            <!-- Additional Information -->
                            <div class="form-group">
                                <label for="additionalInfo"><i class="fas fa-comment"></i> Additional
                                    Information</label>
                                <textarea id="additionalInfo" name="additionalInfo"
                                    placeholder="Any special requirements or instructions..." rows="4"
                                    maxlength="500"></textarea>
                                <div class="character-counter">
                                    <span id="charCount">0</span> / 500 characters
                                </div>
                            </div>

                            <!-- Review Summary -->
                            <div class="review-summary">
                                <h4 style="color: #ff6347; margin-bottom: 15px;">
                                    <i class="fas fa-eye"></i> Booking Summary
                                </h4>
                                <div id="reviewContent"
                                    style="background: #1a1a1a; padding: 20px; border-radius: 10px;">
                                    <!-- Summary will be populated dynamically -->
                                </div>
                            </div>

                            <div class="form-navigation">
                                <button type="button" class="booking-nav-btn booking-btn-prev" onclick="prevStep()">
                                    <i class="fas fa-arrow-left"></i> Previous
                                </button>
                                <button type="submit" class="booking-submit-btn" id="submitBtn">
                                    <i class="fas fa-paper-plane"></i>
                                    <span>Confirm Booking</span>
                                </button>
                            </div>
                        </div>
                    </form>
                </div>

                <!-- Booking Summary Sidebar -->
                <div class="booking-summary fade-in">
                    <div class="summary-header">
                        <i class="fas fa-receipt" style="font-size: 1.5rem;"></i>
                        <h3>Booking Summary</h3>
                    </div>

                    <!-- Price Calculator -->
                    <div class="price-calculator">
                        <h4><i class="fas fa-calculator"></i> Price Estimate</h4>

                        <div class="price-slider-group">
                            <div class="slider-label">
                                <span>Distance</span>
                                <span id="distanceValue">0 km</span>
                            </div>
                            <input type="range" class="price-slider" id="distanceSlider" min="0" max="2000" value="0"
                                step="10">
                        </div>

                        <div class="price-breakdown" id="priceBreakdown">
                            <div class="price-item">
                                <span>Base Fare:</span>
                                <span id="baseFare">â‚¹ 0</span>
                            </div>
                            <div class="price-item">
                                <span>Distance Charge:</span>
                                <span id="distanceCharge">â‚¹ 0</span>
                            </div>
                            <div class="price-item" id="addonsTotal" style="display: none;">
                                <span>Add-on Services:</span>
                                <span id="addonsPrice">â‚¹ 0</span>
                            </div>
                            <div class="price-item">
                                <span>GST (18%):</span>
                                <span id="gst">â‚¹ 0</span>
                            </div>
                            <div class="price-item total">
                                <span>Total Amount:</span>
                                <span id="totalPrice">â‚¹ 0</span>
                            </div>
                        </div>

                        <div class="discount-badge" id="discountBadge" style="display: none;">
                            <i class="fas fa-tag"></i> 10% First Booking Discount Applied!
                        </div>
                    </div>

                    <!-- Popular Routes -->
                    <div class="popular-routes" style="margin-bottom: 20px;">
                        <h5><i class="fas fa-fire" style="color: #ff6347;"></i> Popular Routes</h5>
                        <div class="route-item" style="cursor: pointer;" onclick="fillRoute('Mumbai', 'Delhi')">
                            <div class="route-cities">
                                <span>Mumbai</span>
                                <i class="fas fa-arrow-right route-arrow"></i>
                                <span>Delhi</span>
                            </div>
                            <div class="route-stats">
                                <span class="route-stat"><strong>1,424</strong> km</span>
                                <span class="peak-indicator high"><i class="fas fa-fire"></i> High Demand</span>
                            </div>
                        </div>
                        <div class="route-item" style="cursor: pointer;" onclick="fillRoute('Bangalore', 'Hyderabad')">
                            <div class="route-cities">
                                <span>Bangalore</span>
                                <i class="fas fa-arrow-right route-arrow"></i>
                                <span>Hyderabad</span>
                            </div>
                            <div class="route-stats">
                                <span class="route-stat"><strong>569</strong> km</span>
                            </div>
                        </div>
                        <div class="route-item" style="cursor: pointer;" onclick="fillRoute('Pune', 'Goa')">
                            <div class="route-cities">
                                <span>Pune</span>
                                <i class="fas fa-arrow-right route-arrow"></i>
                                <span>Goa</span>
                            </div>
                            <div class="route-stats">
                                <span class="route-stat"><strong>464</strong> km</span>
                                <span class="peak-indicator"><i class="fas fa-chart-line"></i> Trending</span>
                            </div>
                        </div>
                    </div>

                    <!-- Distance Estimate -->
                    <div class="distance-estimate" id="distanceEstimate">
                        <div class="label">Estimated Distance</div>
                        <div class="distance" style="color: #666;">Select cities to calculate</div>
                    </div>

                    <!-- Popular Routes -->
                    <div class="popular-routes" style="margin-bottom: 20px;">
                        <h5><i class="fas fa-fire" style="color: #ff6347;"></i> Popular Routes</h5>
                        <div class="route-item" style="cursor: pointer;" onclick="fillRoute('Mumbai', 'Delhi')">
                            <div class="route-cities">
                                <span>Mumbai</span>
                                <i class="fas fa-arrow-right route-arrow"></i>
                                <span>Delhi</span>
                            </div>
                            <div class="route-stats">
                                <span class="route-stat"><strong>1,424</strong> km</span>
                                <span class="peak-indicator high"><i class="fas fa-fire"></i> High Demand</span>
                            </div>
                        </div>
                        <div class="route-item" style="cursor: pointer;" onclick="fillRoute('Bangalore', 'Hyderabad')">
                            <div class="route-cities">
                                <span>Bangalore</span>
                                <i class="fas fa-arrow-right route-arrow"></i>
                                <span>Hyderabad</span>
                            </div>
                            <div class="route-stats">
                                <span class="route-stat"><strong>569</strong> km</span>
                            </div>
                        </div>
                        <div class="route-item" style="cursor: pointer;" onclick="fillRoute('Pune', 'Goa')">
                            <div class="route-cities">
                                <span>Pune</span>
                                <i class="fas fa-arrow-right route-arrow"></i>
                                <span>Goa</span>
                            </div>
                            <div class="route-stats">
                                <span class="route-stat"><strong>464</strong> km</span>
                                <span class="peak-indicator"><i class="fas fa-chart-line"></i> Trending</span>
                            </div>
                        </div>
                    </div>

                    <!-- Booking Details -->
                    <div class="summary-section">
                        <h4>Personal Info</h4>
                        <div class="summary-item">
                            <span class="summary-label">Name:</span>
                            <span class="summary-value empty" id="summaryName">Not provided</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Phone:</span>
                            <span class="summary-value empty" id="summaryPhone">Not provided</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Email:</span>
                            <span class="summary-value empty" id="summaryEmail">Not provided</span>
                        </div>
                    </div>

                    <div class="summary-section">
                        <h4>Vehicle Details</h4>
                        <div class="summary-item">
                            <span class="summary-label">Type:</span>
                            <span class="summary-value empty" id="summaryVehicleType">Not selected</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Model:</span>
                            <span class="summary-value empty" id="summaryVehicleModel">Not provided</span>
                        </div>
                    </div>

                    <div class="summary-section">
                        <h4>Transport Details</h4>
                        <div class="summary-item">
                            <span class="summary-label">From:</span>
                            <span class="summary-value empty" id="summaryPickup">Not set</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">To:</span>
                            <span class="summary-value empty" id="summaryDrop">Not set</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Date:</span>
                            <span class="summary-value empty" id="summaryDate">Not selected</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Time:</span>
                            <span class="summary-value empty" id="summaryTime">Any time</span>
                        </div>
                    </div>

                    <!-- Delivery Estimate -->
                    <div class="delivery-estimate">
                        <div class="label">Estimated Delivery Date</div>
                        <div class="date" id="estimatedDelivery">Select pickup date</div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="summary-actions">
                        <button class="summary-btn btn-download" onclick="downloadPDF()">
                            <i class="fas fa-download"></i> Download PDF
                        </button>
                        <button class="summary-btn btn-print" onclick="printSummary()">
                            <i class="fas fa-print"></i> Print Summary
                        </button>
                    </div>
                </div>
            </div>

            <!-- Interactive Map Section -->
            <div class="map-section" style="margin-top: 40px;">
                <div class="map-container-wrapper fade-in">
                    <div class="map-header">
                        <h3>
                            <i class="fas fa-map-marked-alt"></i>
                            Interactive Location Map
                        </h3>
                        <p>View the route between selected cities or explore locations</p>
                    </div>

                    <div id="map" style="position: relative;"></div>
                    <div class="map-3d-indicator" id="map3DIndicator">
                        <i class="fas fa-cube"></i> 3D View Active
                    </div>

                    <div class="map-controls">
                        <button class="map-control-btn" id="satelliteViewBtn" onclick="toggleSatelliteView()">
                            <i class="fas fa-satellite"></i> Satellite View
                        </button>
                        <button class="map-control-btn" id="enable3DBtn" onclick="toggle3DView()">
                            <i class="fas fa-cube"></i> 3D View
                        </button>
                        <button class="map-control-btn" id="trafficLayerBtn" onclick="toggleTrafficLayer()">
                            <i class="fas fa-traffic-light"></i> Traffic
                        </button>
                        <button class="map-control-btn" id="serviceCentersBtn" onclick="toggleServiceCenters()">
                            <i class="fas fa-tools"></i> Service Centers
                        </button>
                        <button class="map-control-btn" id="restStopsBtn" onclick="toggleRestStops()">
                            <i class="fas fa-coffee"></i> Rest Stops
                        </button>
                        <button class="map-control-btn" id="tollPlazasBtn" onclick="toggleTollPlazas()">
                            <i class="fas fa-coins"></i> Toll Plazas
                        </button>
                        <button class="map-control-btn" id="alternativeRoutesBtn" onclick="toggleAlternativeRoutes()">
                            <i class="fas fa-code-branch"></i> Alt Routes
                        </button>
                        <button class="map-control-btn" id="streetViewBtn" onclick="openStreetViewPanel()">
                            <i class="fas fa-street-view"></i> Street View
                        </button>
                        <button class="map-control-btn" id="clearRouteBtn" onclick="clearRoute()">
                            <i class="fas fa-trash"></i> Clear Route
                        </button>
                        <button class="map-control-btn" id="centerMapBtn" onclick="centerMap()">
                            <i class="fas fa-crosshairs"></i> Center Map
                        </button>
                    </div>

                    <!-- Street View Panel -->
                    <div class="street-view-panel" id="streetViewPanel" style="display: none;">
                        <div class="street-view-header">
                            <h4><i class="fas fa-street-view"></i> Street View Preview</h4>
                            <button class="close-street-view" onclick="closeStreetViewPanel()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="street-view-content">
                            <iframe id="streetViewFrame" width="100%" height="400" frameborder="0"
                                style="border:0; border-radius: 10px;"></iframe>
                            <p style="color: #999; font-size: 0.85rem; margin-top: 10px; text-align: center;">
                                Click on the map to preview street view at that location
                            </p>
                        </div>
                    </div>

                    <!-- Alternative Routes Comparison -->
                    <div class="alternative-routes-panel" id="alternativeRoutesPanel" style="display: none;">
                        <h4><i class="fas fa-code-branch"></i> Alternative Routes Comparison</h4>
                        <div class="routes-comparison" id="routesComparison">
                            <!-- Routes will be populated dynamically -->
                        </div>
                    </div>

                    <div class="route-info" id="routeInfo">
                        <h4><i class="fas fa-info-circle"></i> Route Information</h4>
                        <div class="route-details">
                            <div class="route-detail-item">
                                <label>Distance</label>
                                <span id="routeDistance">-- km</span>
                            </div>
                            <div class="route-detail-item">
                                <label>Estimated Time</label>
                                <span id="routeTime">-- hours</span>
                            </div>
                            <div class="route-detail-item">
                                <label>Estimated Cost</label>
                                <span id="routeCost">â‚¹ --</span>
                            </div>
                            <div class="route-detail-item">
                                <label>Toll Cost</label>
                                <span id="routeTollCost">â‚¹ --</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Success Modal -->
    <div class="modal" id="successModal">
        <div class="modal-content">
            <div class="confetti-container" id="confettiContainer"></div>

            <!-- Animated Checkmark SVG -->
            <svg class="success-animation" viewBox="0 0 52 52">
                <circle class="checkmark-circle" cx="26" cy="26" r="25" fill="none" />
                <path class="checkmark-check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8" />
            </svg>

            <h3>ðŸŽ‰ Booking Confirmed!</h3>
            <p>Thank you for choosing Harihar Car Carriers. Your booking has been successfully submitted.</p>

            <div class="booking-reference">
                <div class="label">Booking Reference Number</div>
                <div class="ref-number" id="bookingRef">HC2024-001</div>
            </div>

            <p style="font-size: 0.9rem; color: #999;">
                A confirmation email has been sent to your registered email address.
                Our team will contact you within 24 hours.
            </p>

            <button class="modal-btn" onclick="closeModal()">
                <i class="fas fa-check"></i> Got It!
            </button>

            <button class="modal-btn" onclick="closeModal(); openManageBooking();"
                style="background: #444; margin-top: 10px;">
                <i class="fas fa-edit"></i> Manage Booking
            </button>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Auto-Save Indicator -->
    <div class="auto-save-indicator" id="autoSaveIndicator">
        <i class="fas fa-check-circle"></i>
        <span>Draft saved automatically</span>
    </div>

    <!-- Floating Manage Booking Button (for testing) -->
    <button onclick="openManageBooking()"
        style="position: fixed; bottom: 100px; right: 20px; z-index: 999; background: linear-gradient(135deg, #ff6347, #ff4500); color: white; border: none; padding: 15px 25px; border-radius: 50px; font-family: 'Poppins', sans-serif; font-weight: 600; cursor: pointer; box-shadow: 0 5px 20px rgba(255, 99, 71, 0.4); display: flex; align-items: center; gap: 10px; transition: all 0.3s ease;"
        onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 8px 25px rgba(255, 99, 71, 0.5)'"
        onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 5px 20px rgba(255, 99, 71, 0.4)'">
        <i class="fas fa-edit"></i>
        <span>Manage Booking</span>
    </button>

    <!-- Save Email Modal -->
    <div class="save-email-modal" id="saveEmailModal">
        <div class="save-email-content">
            <h3><i class="fas fa-envelope"></i> Save & Continue Later</h3>
            <p>Enter your email to receive a link to continue this booking later.</p>
            <input type="email" class="save-email-input" id="saveEmail" name="saveEmail" placeholder="your.email@example.com" />
            <div class="save-email-actions">
                <button class="btn-send-link" onclick="sendSaveLink()">
                    <i class="fas fa-paper-plane"></i> Send Link
                </button>
                <button class="btn-cancel-save" onclick="closeSaveEmailModal()">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <!-- Manage Booking Modal -->
    <div class="manage-booking-modal" id="manageBookingModal">
        <div class="manage-booking-content">
            <div class="manage-booking-header">
                <h3><i class="fas fa-edit"></i> Manage Booking</h3>
                <button class="close-modal-btn" onclick="closeManageBooking()">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="booking-actions-grid">
                <div class="action-card" onclick="editBooking()">
                    <i class="fas fa-pencil-alt"></i>
                    <h4>Edit Details</h4>
                    <p>Modify booking information</p>
                </div>
                <div class="action-card" onclick="openRescheduleModal()">
                    <i class="fas fa-calendar-alt"></i>
                    <h4>Reschedule</h4>
                    <p>Change pickup date/time</p>
                </div>
                <div class="action-card" onclick="openCancelModal()">
                    <i class="fas fa-times-circle"></i>
                    <h4>Cancel Booking</h4>
                    <p>Cancel with refund</p>
                </div>
                <div class="action-card" onclick="openTransferModal()">
                    <i class="fas fa-user-friends"></i>
                    <h4>Transfer Booking</h4>
                    <p>Transfer to another person</p>
                </div>
                <div class="action-card" onclick="openUpgradeModal()">
                    <i class="fas fa-arrow-up"></i>
                    <h4>Upgrade/Downgrade</h4>
                    <p>Change vehicle type</p>
                </div>
                <div class="action-card" onclick="openAddonsModal()">
                    <i class="fas fa-plus-square"></i>
                    <h4>Add Services</h4>
                    <p>Add cleaning, detailing</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Reschedule Modal -->
    <div class="manage-booking-modal" id="rescheduleModal">
        <div class="manage-booking-content">
            <div class="manage-booking-header">
                <h3><i class="fas fa-calendar-alt"></i> Reschedule Booking</h3>
                <button class="close-modal-btn" onclick="closeRescheduleModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="form-group">
                <label for="newPickupDate"><i class="fas fa-calendar"></i> New Pickup Date</label>
                <input type="date" id="newPickupDate" name="newPickupDate" class="save-email-input" style="margin-bottom: 15px;">
            </div>

            <div class="form-group">
                <label for="newPickupTime"><i class="fas fa-clock"></i> New Pickup Time</label>
                <select id="newPickupTime" class="save-email-input" style="margin-bottom: 15px;">
                    <option value="any">Any Time</option>
                    <option value="morning">Morning (8 AM - 12 PM)</option>
                    <option value="afternoon">Afternoon (12 PM - 5 PM)</option>
                    <option value="evening">Evening (5 PM - 8 PM)</option>
                </select>
            </div>

            <div class="fee-structure">
                <h4><i class="fas fa-receipt"></i> Rescheduling Fee</h4>
                <div class="fee-item">
                    <span>More than 48 hours before pickup</span>
                    <span class="fee-amount">FREE</span>
                </div>
                <div class="fee-item">
                    <span>24-48 hours before pickup</span>
                    <span class="fee-amount">â‚¹500</span>
                </div>
                <div class="fee-item">
                    <span>Less than 24 hours</span>
                    <span class="fee-amount">â‚¹1,000</span>
                </div>
            </div>

            <div class="save-email-actions">
                <button class="btn-send-link" onclick="confirmReschedule()">
                    <i class="fas fa-check"></i> Confirm Reschedule
                </button>
                <button class="btn-cancel-save" onclick="closeRescheduleModal()">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <!-- Cancel Booking Modal -->
    <div class="manage-booking-modal" id="cancelModal">
        <div class="manage-booking-content">
            <div class="manage-booking-header">
                <h3><i class="fas fa-times-circle"></i> Cancel Booking</h3>
                <button class="close-modal-btn" onclick="closeCancelModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="refund-policy">
                <h4><i class="fas fa-money-bill-wave"></i> Refund Policy</h4>
                <div class="refund-tier">
                    <i class="fas fa-check-circle tier-icon" style="color: #4CAF50;"></i>
                    <div class="tier-info">
                        <div class="tier-label">More than 72 hours</div>
                        <div class="tier-desc">Cancel more than 3 days before pickup</div>
                    </div>
                    <div class="tier-amount">100%</div>
                </div>
                <div class="refund-tier">
                    <i class="fas fa-info-circle tier-icon" style="color: #FFC107;"></i>
                    <div class="tier-info">
                        <div class="tier-label">48-72 hours</div>
                        <div class="tier-desc">Cancel 2-3 days before pickup</div>
                    </div>
                    <div class="tier-amount">75%</div>
                </div>
                <div class="refund-tier">
                    <i class="fas fa-exclamation-circle tier-icon" style="color: #FF9800;"></i>
                    <div class="tier-info">
                        <div class="tier-label">24-48 hours</div>
                        <div class="tier-desc">Cancel 1-2 days before pickup</div>
                    </div>
                    <div class="tier-amount">50%</div>
                </div>
                <div class="refund-tier">
                    <i class="fas fa-times-circle tier-icon" style="color: #ff6347;"></i>
                    <div class="tier-info">
                        <div class="tier-label">Less than 24 hours</div>
                        <div class="tier-desc">Cancel within 24 hours of pickup</div>
                    </div>
                    <div class="tier-amount">25%</div>
                </div>
            </div>

            <div class="form-group">
                <label for="cancelReason"><i class="fas fa-comment"></i> Reason for Cancellation</label>
                <textarea id="cancelReason" class="save-email-input" rows="3"
                    placeholder="Please tell us why you're cancelling..."></textarea>
            </div>

            <div class="save-email-actions">
                <button class="btn-send-link" style="background: #dc3545;" onclick="confirmCancellation()">
                    <i class="fas fa-trash"></i> Confirm Cancellation
                </button>
                <button class="btn-cancel-save" onclick="closeCancelModal()">
                    Keep Booking
                </button>
            </div>
        </div>
    </div>

    <!-- Transfer Booking Modal -->
    <div class="manage-booking-modal" id="transferModal">
        <div class="manage-booking-content">
            <div class="manage-booking-header">
                <h3><i class="fas fa-user-friends"></i> Transfer Booking</h3>
                <button class="close-modal-btn" onclick="closeTransferModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <p style="color: #ccc; margin-bottom: 20px;">Transfer this booking to another person. They will receive all
                booking details and notifications.</p>

            <div class="form-group">
                <label for="transferName"><i class="fas fa-user"></i> Recipient Name</label>
                <input type="text" id="transferName" name="transferName" class="save-email-input" placeholder="Enter full name">
            </div>

            <div class="form-group">
                <label for="transferEmail"><i class="fas fa-envelope"></i> Recipient Email</label>
                <input type="email" id="transferEmail" name="transferEmail" class="save-email-input" placeholder="Enter email address">
            </div>

            <div class="form-group">
                <label for="transferPhone"><i class="fas fa-phone"></i> Recipient Phone</label>
                <input type="tel" id="transferPhone" name="transferPhone" class="save-email-input" placeholder="Enter 10-digit phone number">
            </div>

            <div class="fee-structure">
                <h4><i class="fas fa-receipt"></i> Transfer Fee</h4>
                <div class="fee-item">
                    <span>Booking transfer processing fee</span>
                    <span class="fee-amount">â‚¹200</span>
                </div>
            </div>

            <div class="save-email-actions">
                <button class="btn-send-link" onclick="confirmTransfer()">
                    <i class="fas fa-exchange-alt"></i> Transfer Booking
                </button>
                <button class="btn-cancel-save" onclick="closeTransferModal()">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <!-- Upgrade/Downgrade Modal -->
    <div class="manage-booking-modal" id="upgradeModal">
        <div class="manage-booking-content">
            <div class="manage-booking-header">
                <h3><i class="fas fa-arrow-up"></i> Change Vehicle Type</h3>
                <button class="close-modal-btn" onclick="closeUpgradeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <p style="color: #ccc; margin-bottom: 20px;">Current Vehicle: <strong id="currentVehicleType"
                    style="color: #ff6347;">Sedan</strong></p>

            <div class="form-group">
                <label for="newVehicleType"><i class="fas fa-car"></i> Select New Vehicle Type</label>
                <select id="newVehicleType" class="save-email-input" onchange="calculateUpgradeFee()">
                    <option value="">Select Vehicle Type</option>
                    <option value="hatchback">Hatchback (Downgrade -â‚¹500)</option>
                    <option value="sedan">Sedan (Current)</option>
                    <option value="suv">SUV (Upgrade +â‚¹1,000)</option>
                    <option value="luxury">Luxury Car (Upgrade +â‚¹2,500)</option>
                    <option value="bike">Motorcycle (Downgrade -â‚¹1,000)</option>
                </select>
            </div>

            <div class="fee-structure" id="upgradeFeeStructure" style="display: none;">
                <h4><i class="fas fa-calculator"></i> Price Adjustment</h4>
                <div class="fee-item">
                    <span>Original Price</span>
                    <span class="fee-amount" id="originalPrice">â‚¹5,000</span>
                </div>
                <div class="fee-item">
                    <span id="adjustmentLabel">Upgrade Fee</span>
                    <span class="fee-amount" id="adjustmentAmount">+â‚¹1,000</span>
                </div>
                <div class="fee-item" style="border-top: 2px solid #444; padding-top: 10px; margin-top: 10px;">
                    <span style="font-weight: 600;">New Total</span>
                    <span class="fee-amount" id="newTotalPrice" style="font-size: 1.2rem;">â‚¹6,000</span>
                </div>
            </div>

            <div class="save-email-actions">
                <button class="btn-send-link" onclick="confirmVehicleChange()">
                    <i class="fas fa-check"></i> Confirm Change
                </button>
                <button class="btn-cancel-save" onclick="closeUpgradeModal()">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <!-- Cart Abandonment Banner -->
    <div class="abandonment-banner" id="abandonmentBanner">
        <div class="abandonment-content">
            <i class="fas fa-gift abandonment-icon"></i>
            <div class="abandonment-text">
                <h4>Still thinking? Get 10% off! ðŸŽ‰</h4>
                <p>Complete your booking in the next 10 minutes and save â‚¹<span id="discountAmount">500</span></p>
            </div>
            <button class="abandonment-close" onclick="closeAbandonmentBanner()">
                <i class="fas fa-times"></i>
            </button>
        </div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <!-- Leaflet Routing Machine -->
    <script src="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.js"></script>

    <!-- Leaflet Control Geocoder -->
    <script src="https://unpkg.com/leaflet-control-geocoder@2.4.0/dist/Control.Geocoder.js"></script>

    <!-- Leaflet Marker Cluster -->
    <script src="https://cdn.jsdelivr.net/npm/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>

    <!-- Booking Modals Module -->
    <script src="../js/modules/booking-modals.js"></script>


    <!-- Footer -->
    <div id="footer-container"></div>
    <script src="../js/modules/footer-loader.js"></script>
    <!-- Component Initializer - Ensures global components (FAB, Chatbot, etc.) are available -->
    <script src="../js/modules/component-initializer.js"></script>
    <script src="../js/modules/themes.js"></script>

    <!-- ðŸŒŸ Bottom Fixed Action Bar -->
   <link rel="stylesheet" href="../css/components/footer.css" />
  <link rel="stylesheet" href="../css/components/sticky-quote-button.css" />
  <link rel="stylesheet" href="../css/components/quote-modal.css" />
  <link rel="stylesheet" href="../css/components/bottom-fixed-container.css">
  
  <!-- ðŸš€ Floating Action Menu loaded via footer component -->
   <script src="../js/script.js"></script>
   <script src="../js/modules/booking.js"></script>
</body>

</html>