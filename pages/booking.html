<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Vehicle Transport - Harihar Car Carriers</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin=""/>
    
    <!-- Leaflet Routing Machine CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.css" />
    
    <!-- Leaflet Control Geocoder CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder@2.4.0/dist/Control.Geocoder.css" />
    
    <!-- Lottie Animation -->
    <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Poppins", sans-serif;
            background-color: #2b2b2b;
            color: white;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Hero Section */
        .booking-hero {
            padding: 150px 0 80px;
            background: linear-gradient(rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.8)),
                url('https://images.unsplash.com/photo-1568605117036-5fe5e7bab0b7?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80');
            background-size: cover;
            background-position: center;
            text-align: center;
        }

        .booking-hero h1 {
            font-size: 3.5rem;
            margin-bottom: 20px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
        }

        .booking-hero p {
            font-size: 1.3rem;
            max-width: 700px;
            margin: 0 auto 30px;
            opacity: 0.9;
        }

        /* Booking Section */
        .booking-section {
            padding: 80px 0;
            background-color: #333;
        }

        .booking-container {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 40px;
            align-items: start;
        }

        /* Progress Bar */
        .progress-container {
            background: #1a1a1a;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 1px solid #444;
        }

        .progress-steps {
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            margin-bottom: 15px;
        }

        .progress-line {
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            height: 3px;
            background: #444;
            z-index: 0;
        }

        .progress-line-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff6347, #ff4500);
            width: 0%;
            transition: width 0.4s ease;
        }

        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 1;
        }

        .step-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #444;
            border: 3px solid #444;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            transition: all 0.3s ease;
            position: relative;
        }

        .step.active .step-circle {
            background: #ff6347;
            border-color: #ff6347;
            box-shadow: 0 0 20px rgba(255, 99, 71, 0.5);
        }

        .step.completed .step-circle {
            background: #4CAF50;
            border-color: #4CAF50;
        }

        .step.completed .step-circle i {
            display: block;
        }

        .step-circle i {
            display: none;
        }

        .step-label {
            margin-top: 10px;
            font-size: 0.85rem;
            color: #999;
            font-weight: 500;
            text-align: center;
        }

        .step.active .step-label {
            color: #ff6347;
        }

        .step.completed .step-label {
            color: #4CAF50;
        }

        .progress-percentage {
            text-align: center;
            color: #ff6347;
            font-weight: 600;
            font-size: 0.9rem;
            margin-top: 10px;
        }

        /* Form Steps */
        .form-step {
            display: none;
        }

        .form-step.active {
            display: block;
            animation: slideIn 0.4s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .step-header {
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #444;
        }

        .step-header h3 {
            color: #ff6347;
            font-size: 1.3rem;
            margin-bottom: 5px;
        }

        .step-header p {
            color: #999;
            font-size: 0.9rem;
        }

        /* Booking Form */
        .booking-form-container {
            background: linear-gradient(145deg, #2b2b2b, #333);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            border: 1px solid #444;
            position: relative;
        }

        .booking-form-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #ff6347, #ff4500);
        }

        .form-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .form-header h2 {
            font-size: 2rem;
            color: white;
            margin-bottom: 8px;
        }

        .form-header p {
            color: #ff6347;
            font-size: 1rem;
        }

        .booking-form {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .form-group {
            position: relative;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #ccc;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-group label i {
            color: #ff6347;
            width: 16px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 15px;
            background: #1a1a1a;
            border: 2px solid #444;
            border-radius: 10px;
            color: white;
            font-family: "Poppins", sans-serif;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #ff6347;
            box-shadow: 0 0 0 3px rgba(255, 99, 71, 0.1);
            background: #222;
        }

        .form-group input.error,
        .form-group select.error,
        .form-group textarea.error {
            border-color: #ff3860;
            box-shadow: 0 0 0 3px rgba(255, 56, 96, 0.1);
        }

        .form-group.valid input,
        .form-group.valid select {
            border-color: #4CAF50;
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
        }

        .validation-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2rem;
            display: none;
        }

        .validation-icon.success {
            color: #4CAF50;
            display: block;
            animation: checkmark 0.5s ease;
        }

        .validation-icon.error {
            color: #ff3860;
            display: block;
        }

        @keyframes checkmark {
            0% {
                transform: translateY(-50%) scale(0);
            }
            50% {
                transform: translateY(-50%) scale(1.2);
            }
            100% {
                transform: translateY(-50%) scale(1);
            }
        }

        .character-counter {
            font-size: 0.8rem;
            color: #999;
            text-align: right;
            margin-top: 5px;
        }

        .character-counter.warning {
            color: #ffa500;
        }

        .character-counter.danger {
            color: #ff3860;
        }

        .error-message {
            color: #ff3860;
            font-size: 0.85rem;
            margin-top: 5px;
            display: none;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Navigation Buttons */
        .form-navigation {
            display: flex;
            justify-content: space-between;
            gap: 15px;
            margin-top: 25px;
        }

        .booking-nav-btn {
            flex: 1;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-family: "Poppins", sans-serif;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            min-height: 55px;
        }

        .booking-btn-prev {
            background: #444;
            color: white;
        }

        .booking-btn-prev:hover {
            background: #555;
            transform: translateX(-3px);
        }

        .booking-btn-next {
            background: linear-gradient(135deg, #ff6347, #ff4500);
            color: white;
        }

        .booking-btn-next:hover {
            transform: translateX(3px);
            box-shadow: 0 5px 15px rgba(255, 99, 71, 0.4);
        }

        .booking-btn-prev:disabled,
        .booking-btn-next:disabled {
            background: #333;
            cursor: not-allowed;
            opacity: 0.5;
            transform: none;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .date-time-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .location-input-wrapper {
            position: relative;
        }

        .map-btn {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            background: #ff6347;
            border: none;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .map-btn:hover {
            background: #ff4500;
        }

        .booking-submit-btn {
            flex: 1;
            background: linear-gradient(135deg, #ff6347, #ff4500);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-family: "Poppins", sans-serif;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s ease;
            min-height: 55px;
            box-shadow: 0 5px 15px rgba(255, 99, 71, 0.3);
        }

        .booking-submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 99, 71, 0.4);
            background: linear-gradient(135deg, #ff4500, #ff6347);
        }

        .booking-submit-btn:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Booking Summary Sidebar */
        .booking-summary {
            background: #2b2b2b;
            padding: 25px;
            border-radius: 20px;
            border: 1px solid #444;
            position: sticky;
            top: 20px;
            max-height: calc(100vh - 40px);
            overflow-y: auto;
        }

        .summary-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #444;
        }

        .summary-header h3 {
            color: #ff6347;
            font-size: 1.3rem;
        }

        .summary-section {
            margin-bottom: 20px;
        }

        .summary-section h4 {
            color: #ccc;
            font-size: 0.9rem;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #333;
        }

        .summary-item:last-child {
            border-bottom: none;
        }

        .summary-label {
            color: #999;
            font-size: 0.9rem;
        }

        .summary-value {
            color: white;
            font-weight: 500;
            text-align: right;
        }

        .summary-value.empty {
            color: #666;
            font-style: italic;
        }

        .price-calculator {
            background: #1a1a1a;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .price-calculator h4 {
            color: #ff6347;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .price-breakdown {
            margin-bottom: 15px;
        }

        .price-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            color: #ccc;
            font-size: 0.9rem;
        }

        .price-item.total {
            border-top: 2px solid #444;
            margin-top: 10px;
            padding-top: 15px;
            font-size: 1.2rem;
            font-weight: 600;
            color: #ff6347;
        }

        .price-slider-group {
            margin: 15px 0;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            color: #ccc;
            font-size: 0.85rem;
        }

        .price-slider {
            width: 100%;
            height: 6px;
            border-radius: 5px;
            background: #444;
            outline: none;
            -webkit-appearance: none;
        }

        .price-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #ff6347;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .price-slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 0 10px rgba(255, 99, 71, 0.5);
        }

        .price-slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #ff6347;
            cursor: pointer;
            border: none;
        }

        .discount-badge {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            display: inline-block;
            margin-top: 10px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }

        .summary-actions {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }

        .summary-btn {
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-family: "Poppins", sans-serif;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-download {
            background: #444;
            color: white;
        }

        .btn-download:hover {
            background: #555;
        }

        .btn-print {
            background: transparent;
            color: #ff6347;
            border: 2px solid #ff6347;
        }

        .btn-print:hover {
            background: #ff6347;
            color: white;
        }

        .delivery-estimate {
            background: #333;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            text-align: center;
        }

        .delivery-estimate .label {
            color: #999;
            font-size: 0.85rem;
            margin-bottom: 5px;
        }

        .delivery-estimate .date {
            color: #4CAF50;
            font-size: 1.1rem;
            font-weight: 600;
        }

        /* Autocomplete Dropdown Styles */
        .autocomplete-wrapper {
            position: relative;
        }

        .autocomplete-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: #1a1a1a;
            border: 2px solid #444;
            border-top: none;
            border-radius: 0 0 10px 10px;
            max-height: 250px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .autocomplete-dropdown.show {
            display: block;
        }

        .autocomplete-item {
            padding: 12px 15px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #ccc;
            border-bottom: 1px solid #333;
        }

        .autocomplete-item:last-child {
            border-bottom: none;
        }

        .autocomplete-item:hover,
        .autocomplete-item.active {
            background: #ff6347;
            color: white;
        }

        .autocomplete-item strong {
            color: #ff6347;
        }

        .autocomplete-item:hover strong {
            color: white;
        }

        /* Map Container */
        .map-section {
            margin-top: 40px;
        }

        .map-container-wrapper {
            background: #2b2b2b;
            padding: 30px;
            border-radius: 20px;
            border: 1px solid #444;
        }

        .map-header {
            margin-bottom: 20px;
        }

        .map-header h3 {
            font-size: 1.5rem;
            color: white;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .map-header p {
            color: #ccc;
            font-size: 0.9rem;
        }

        #map {
            height: 500px;
            width: 100%;
            border-radius: 15px;
            border: 2px solid #444;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            transition: all 0.3s ease;
        }

        #map:hover {
            box-shadow: 0 15px 40px rgba(255, 99, 71, 0.2);
        }

        .map-controls {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .map-control-btn {
            background: #444;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-family: "Poppins", sans-serif;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .map-control-btn:hover {
            background: #ff6347;
        }

        .map-control-btn.active {
            background: #ff6347;
        }

        .route-info {
            background: #333;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            display: none;
        }

        .route-info.show {
            display: block;
        }

        .route-info h4 {
            color: #ff6347;
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .route-details {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
        }

        .route-detail-item {
            flex: 1;
            min-width: 150px;
        }

        .route-detail-item label {
            color: #999;
            font-size: 0.85rem;
            display: block;
            margin-bottom: 5px;
        }

        .route-detail-item span {
            color: white;
            font-size: 1.1rem;
            font-weight: 600;
        }

        /* Leaflet Custom Styles */
        .leaflet-popup-content-wrapper {
            background: #2b2b2b;
            color: white;
            border-radius: 10px;
        }

        .leaflet-popup-tip {
            background: #2b2b2b;
        }

        .leaflet-control-geocoder {
            background: #2b2b2b;
            border: 2px solid #444;
        }

        .leaflet-control-geocoder input {
            background: #1a1a1a;
            color: white;
            border: 1px solid #444;
        }

        .leaflet-routing-container {
            background: #2b2b2b;
            color: white;
        }

        /* Map Container */
        .map-container-wrapper {
            background: #2b2b2b;
            padding: 30px;
            border-radius: 20px;
            border: 1px solid #444;
        }

        .map-header {
            margin-bottom: 20px;
        }

        .map-header h3 {
            font-size: 1.5rem;
            color: white;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .map-header p {
            color: #ccc;
            font-size: 0.9rem;
        }

        #map {
            height: 500px;
            width: 100%;
            border-radius: 15px;
            border: 2px solid #444;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            transition: all 0.3s ease;
        }

        #map:hover {
            box-shadow: 0 15px 40px rgba(255, 99, 71, 0.2);
        }

        .map-controls {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .map-control-btn {
            background: #444;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-family: "Poppins", sans-serif;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .map-control-btn:hover {
            background: #ff6347;
        }

        .map-control-btn.active {
            background: #ff6347;
        }

        .route-info {
            background: #333;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            display: none;
        }

        .route-info.show {
            display: block;
        }

        .route-info h4 {
            color: #ff6347;
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .route-details {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
        }

        .route-detail-item {
            flex: 1;
            min-width: 150px;
        }

        .route-detail-item label {
            color: #999;
            font-size: 0.85rem;
            display: block;
            margin-bottom: 5px;
        }

        .route-detail-item span {
            color: white;
            font-size: 1.1rem;
            font-weight: 600;
        }

        /* Success Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: #2b2b2b;
            padding: 50px 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 550px;
            width: 90%;
            border: 2px solid #ff6347;
            position: relative;
            animation: modalZoom 0.5s ease;
        }

        @keyframes modalZoom {
            from {
                transform: scale(0.7);
                opacity: 0;
            }
            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        .confetti-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            border-radius: 20px;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #ff6347;
            animation: confettiFall 3s linear;
        }

        @keyframes confettiFall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        .success-animation {
            width: 150px;
            height: 150px;
            margin: 0 auto 20px;
        }

        .animated-checkmark {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            border: 5px solid #4CAF50;
            margin: 0 auto 20px;
            position: relative;
            animation: scaleUp 0.5s ease;
        }

        @keyframes scaleUp {
            0% {
                transform: scale(0);
            }
            50% {
                transform: scale(1.1);
            }
            100% {
                transform: scale(1);
            }
        }

        .checkmark-circle {
            stroke-dasharray: 166;
            stroke-dashoffset: 166;
            stroke-width: 5;
            stroke: #4CAF50;
            fill: none;
            animation: stroke 0.6s cubic-bezier(0.65, 0, 0.45, 1) forwards;
        }

        .checkmark-check {
            transform-origin: 50% 50%;
            stroke-dasharray: 48;
            stroke-dashoffset: 48;
            stroke: #4CAF50;
            stroke-width: 5;
            fill: none;
            animation: stroke 0.3s cubic-bezier(0.65, 0, 0.45, 1) 0.6s forwards;
        }

        @keyframes stroke {
            100% {
                stroke-dashoffset: 0;
            }
        }

        .booking-reference {
            background: #1a1a1a;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px dashed #ff6347;
        }

        .booking-reference .label {
            color: #999;
            font-size: 0.9rem;
            margin-bottom: 5px;
        }

        .booking-reference .ref-number {
            color: #ff6347;
            font-size: 1.5rem;
            font-weight: 700;
            font-family: 'Courier New', monospace;
            letter-spacing: 2px;
            animation: typeWriter 1s steps(12);
            overflow: hidden;
            white-space: nowrap;
            display: inline-block;
        }

        @keyframes typeWriter {
            from {
                width: 0;
            }
            to {
                width: 100%;
            }
        }

        .modal h3 {
            font-size: 1.8rem;
            margin-bottom: 15px;
            color: white;
        }

        .modal p {
            color: #ccc;
            margin-bottom: 25px;
            line-height: 1.6;
        }

        .modal-btn {
            background: #ff6347;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-family: "Poppins", sans-serif;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-btn:hover {
            background: #ff4500;
            transform: translateY(-2px);
        }

        /* Toast Notification */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .toast {
            background: #2b2b2b;
            color: white;
            padding: 16px 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            border-left: 4px solid #ff6347;
            display: flex;
            align-items: center;
            gap: 12px;
            max-width: 350px;
            transform: translateX(400px);
            opacity: 0;
            transition: all 0.3s ease;
        }

        .toast.show {
            transform: translateX(0);
            opacity: 1;
        }

        .toast.hide {
            transform: translateX(400px);
            opacity: 0;
        }

        .toast-icon {
            font-size: 1.5rem;
            color: #ff6347;
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .toast-message {
            font-size: 0.9rem;
            color: #ccc;
        }

        .toast-close {
            background: none;
            border: none;
            color: #ccc;
            cursor: pointer;
            font-size: 1.2rem;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .toast-close:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        /* Leaflet Custom Styles */
        .leaflet-popup-content-wrapper {
            background: #2b2b2b;
            color: white;
            border-radius: 10px;
        }

        .leaflet-popup-tip {
            background: #2b2b2b;
        }

        .leaflet-control-geocoder {
            background: #2b2b2b;
            border: 2px solid #444;
        }

        .leaflet-control-geocoder input {
            background: #1a1a1a;
            color: white;
            border: 1px solid #444;
        }

        .leaflet-routing-container {
            background: #2b2b2b;
            color: white;
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .booking-container {
                grid-template-columns: 1fr;
            }

            .booking-summary {
                position: static;
                max-height: none;
            }
        }

        @media (max-width: 768px) {
            .booking-hero h1 {
                font-size: 2.2rem;
            }

            .booking-form-container,
            .map-container-wrapper {
                padding: 25px 20px;
            }

            .form-row,
            .date-time-row {
                grid-template-columns: 1fr;
            }

            #map {
                height: 400px;
            }

            .route-details {
                flex-direction: column;
            }

            .map-controls {
                justify-content: center;
            }
        }

        @media (max-width: 480px) {
            .booking-hero h1 {
                font-size: 1.8rem;
            }

            #map {
                height: 350px;
            }

            .toast-container {
                top: 10px;
                right: 10px;
                left: 10px;
            }

            .toast {
                max-width: 100%;
            }

            .map-controls {
                flex-direction: column;
            }

            .map-control-btn {
                width: 100%;
            }
        }

        /* Animation */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in {
            animation: fadeInUp 0.6s ease forwards;
        }

        @keyframes shake {
            0%, 100% {
                transform: translateX(0);
            }
            25% {
                transform: translateX(-5px);
            }
            75% {
                transform: translateX(5px);
            }
        }

        .shake {
            animation: shake 0.5s ease-in-out;
        }
    </style>
</head>

<body>
    <!-- Hero Section -->
    <section class="booking-hero">
        <div class="container">
            <h1 class="fade-in">Book Your Vehicle Transport</h1>
            <p class="fade-in">Quick, secure, and reliable vehicle transportation booking with interactive map</p>
        </div>
    </section>

    <!-- Booking Section -->
    <section class="booking-section">
        <div class="container">
            <div class="booking-container">
                <!-- Booking Form -->
                <div class="booking-form-container fade-in">
                    <!-- Progress Bar -->
                    <div class="progress-container">
                        <div class="progress-steps">
                            <div class="progress-line">
                                <div class="progress-line-fill" id="progressFill"></div>
                            </div>
                            <div class="step active" data-step="1">
                                <div class="step-circle">
                                    <span class="step-number">1</span>
                                    <i class="fas fa-check"></i>
                                </div>
                                <div class="step-label">Details</div>
                            </div>
                            <div class="step" data-step="2">
                                <div class="step-circle">
                                    <span class="step-number">2</span>
                                    <i class="fas fa-check"></i>
                                </div>
                                <div class="step-label">Review</div>
                            </div>
                            <div class="step" data-step="3">
                                <div class="step-circle">
                                    <span class="step-number">3</span>
                                    <i class="fas fa-check"></i>
                                </div>
                                <div class="step-label">Confirm</div>
                            </div>
                        </div>
                        <div class="progress-percentage" id="progressPercentage">33% Complete</div>
                    </div>

                    <form class="booking-form" id="bookingForm">
                        <!-- Step 1: Personal & Vehicle Details -->
                        <div class="form-step active" data-step="1">
                            <div class="step-header">
                                <h3><i class="fas fa-user-circle"></i> Personal & Vehicle Information</h3>
                                <p>Tell us about yourself and your vehicle</p>
                            </div>

                            <!-- Personal Information -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="fullName"><i class="fas fa-user"></i> Full Name *</label>
                                    <input type="text" id="fullName" name="fullName" required
                                        placeholder="Enter your full name">
                                    <span class="validation-icon"><i class="fas fa-check-circle"></i></span>
                                    <div class="error-message" id="nameError">Please enter your full name</div>
                                </div>
                                <div class="form-group">
                                    <label for="phone"><i class="fas fa-phone"></i> Phone Number *</label>
                                    <input type="tel" id="phone" name="phone" required placeholder="Enter 10-digit number">
                                    <span class="validation-icon"><i class="fas fa-check-circle"></i></span>
                                    <div class="error-message" id="phoneError">Please enter a valid 10-digit phone number</div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="email"><i class="fas fa-envelope"></i> Email Address *</label>
                                <input type="email" id="email" name="email" required placeholder="Enter your email">
                                <span class="validation-icon"><i class="fas fa-check-circle"></i></span>
                                <div class="error-message" id="emailError">Please enter a valid email address</div>
                            </div>

                            <!-- Vehicle Information -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="vehicleType"><i class="fas fa-car"></i> Vehicle Type *</label>
                                    <select id="vehicleType" name="vehicleType" required>
                                        <option value="">Select Vehicle Type</option>
                                        <option value="hatchback">Hatchback</option>
                                        <option value="sedan">Sedan</option>
                                        <option value="suv">SUV</option>
                                        <option value="luxury">Luxury Car</option>
                                        <option value="bike">Motorcycle</option>
                                        <option value="commercial">Commercial Vehicle</option>
                                    </select>
                                    <span class="validation-icon"><i class="fas fa-check-circle"></i></span>
                                    <div class="error-message" id="vehicleError">Please select vehicle type</div>
                                </div>
                                <div class="form-group">
                                    <label for="vehicleModel"><i class="fas fa-cog"></i> Vehicle Model</label>
                                    <input type="text" id="vehicleModel" name="vehicleModel"
                                        placeholder="e.g., Hyundai Creta">
                                </div>
                            </div>

                            <div class="form-navigation">
                                <button type="button" class="booking-nav-btn booking-btn-prev" disabled>
                                    <i class="fas fa-arrow-left"></i> Previous
                                </button>
                                <button type="button" class="booking-nav-btn booking-btn-next" onclick="nextStep()">
                                    Next <i class="fas fa-arrow-right"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Step 2: Location & Schedule -->
                        <div class="form-step" data-step="2">
                            <div class="step-header">
                                <h3><i class="fas fa-map-marked-alt"></i> Location & Schedule</h3>
                                <p>Set your pickup and delivery details</p>
                            </div>

                            <!-- Location Information -->
                            <div class="form-group">
                                <label for="pickupCity"><i class="fas fa-map-marker-alt"></i> Pickup City *</label>
                                <div class="autocomplete-wrapper">
                                    <input type="text" id="pickupCity" name="pickupCity" required
                                        placeholder="Start typing city name..." autocomplete="off">
                                    <div class="autocomplete-dropdown" id="pickupCityDropdown"></div>
                                </div>
                                <span class="validation-icon"><i class="fas fa-check-circle"></i></span>
                                <div class="error-message" id="pickupError">Please select pickup city</div>
                            </div>

                            <div class="form-group">
                                <label for="dropCity"><i class="fas fa-flag-checkered"></i> Drop City *</label>
                                <div class="autocomplete-wrapper">
                                    <input type="text" id="dropCity" name="dropCity" required
                                        placeholder="Start typing city name..." autocomplete="off">
                                    <div class="autocomplete-dropdown" id="dropCityDropdown"></div>
                                </div>
                                <span class="validation-icon"><i class="fas fa-check-circle"></i></span>
                                <div class="error-message" id="dropError">Please select drop city</div>
                            </div>

                            <!-- Hidden fields for full addresses (optional) -->
                            <input type="hidden" id="pickupLocation" name="pickupLocation">
                            <input type="hidden" id="dropLocation" name="dropLocation">

                            <!-- Date & Time -->
                            <div class="date-time-row">
                                <div class="form-group">
                                    <label for="pickupDate"><i class="fas fa-calendar"></i> Preferred Pickup Date *</label>
                                    <input type="date" id="pickupDate" name="pickupDate" required>
                                    <span class="validation-icon"><i class="fas fa-check-circle"></i></span>
                                    <div class="error-message" id="dateError">Please select pickup date</div>
                                </div>
                                <div class="form-group">
                                    <label for="pickupTime"><i class="fas fa-clock"></i> Preferred Time</label>
                                    <select id="pickupTime" name="pickupTime">
                                        <option value="any">Any Time</option>
                                        <option value="morning">Morning (8 AM - 12 PM)</option>
                                        <option value="afternoon">Afternoon (12 PM - 5 PM)</option>
                                        <option value="evening">Evening (5 PM - 8 PM)</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-navigation">
                                <button type="button" class="booking-nav-btn booking-btn-prev" onclick="prevStep()">
                                    <i class="fas fa-arrow-left"></i> Previous
                                </button>
                                <button type="button" class="booking-nav-btn booking-btn-next" onclick="nextStep()">
                                    Next <i class="fas fa-arrow-right"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Step 3: Review & Confirm -->
                        <div class="form-step" data-step="3">
                            <div class="step-header">
                                <h3><i class="fas fa-clipboard-check"></i> Review & Confirm</h3>
                                <p>Verify your booking details before confirmation</p>
                            </div>

                            <!-- Additional Information -->
                            <div class="form-group">
                                <label for="additionalInfo"><i class="fas fa-comment"></i> Additional Information</label>
                                <textarea id="additionalInfo" name="additionalInfo"
                                    placeholder="Any special requirements or instructions..." rows="4" maxlength="500"></textarea>
                                <div class="character-counter">
                                    <span id="charCount">0</span> / 500 characters
                                </div>
                            </div>

                            <!-- Review Summary -->
                            <div class="review-summary">
                                <h4 style="color: #ff6347; margin-bottom: 15px;">
                                    <i class="fas fa-eye"></i> Booking Summary
                                </h4>
                                <div id="reviewContent" style="background: #1a1a1a; padding: 20px; border-radius: 10px;">
                                    <!-- Summary will be populated dynamically -->
                                </div>
                            </div>

                            <div class="form-navigation">
                                <button type="button" class="booking-nav-btn booking-btn-prev" onclick="prevStep()">
                                    <i class="fas fa-arrow-left"></i> Previous
                                </button>
                                <button type="submit" class="booking-submit-btn" id="submitBtn">
                                    <i class="fas fa-paper-plane"></i>
                                    <span>Confirm Booking</span>
                                </button>
                            </div>
                        </div>
                    </form>
                </div>

                <!-- Booking Summary Sidebar -->
                <div class="booking-summary fade-in">
                    <div class="summary-header">
                        <i class="fas fa-receipt" style="font-size: 1.5rem;"></i>
                        <h3>Booking Summary</h3>
                    </div>

                    <!-- Price Calculator -->
                    <div class="price-calculator">
                        <h4><i class="fas fa-calculator"></i> Price Estimate</h4>
                        
                        <div class="price-slider-group">
                            <div class="slider-label">
                                <span>Distance</span>
                                <span id="distanceValue">0 km</span>
                            </div>
                            <input type="range" class="price-slider" id="distanceSlider" 
                                   min="0" max="2000" value="0" step="10">
                        </div>

                        <div class="price-breakdown" id="priceBreakdown">
                            <div class="price-item">
                                <span>Base Fare:</span>
                                <span id="baseFare">₹ 0</span>
                            </div>
                            <div class="price-item">
                                <span>Distance Charge:</span>
                                <span id="distanceCharge">₹ 0</span>
                            </div>
                            <div class="price-item">
                                <span>GST (18%):</span>
                                <span id="gst">₹ 0</span>
                            </div>
                            <div class="price-item total">
                                <span>Total Amount:</span>
                                <span id="totalPrice">₹ 0</span>
                            </div>
                        </div>

                        <div class="discount-badge" id="discountBadge" style="display: none;">
                            <i class="fas fa-tag"></i> 10% First Booking Discount Applied!
                        </div>
                    </div>

                    <!-- Booking Details -->
                    <div class="summary-section">
                        <h4>Personal Info</h4>
                        <div class="summary-item">
                            <span class="summary-label">Name:</span>
                            <span class="summary-value empty" id="summaryName">Not provided</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Phone:</span>
                            <span class="summary-value empty" id="summaryPhone">Not provided</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Email:</span>
                            <span class="summary-value empty" id="summaryEmail">Not provided</span>
                        </div>
                    </div>

                    <div class="summary-section">
                        <h4>Vehicle Details</h4>
                        <div class="summary-item">
                            <span class="summary-label">Type:</span>
                            <span class="summary-value empty" id="summaryVehicleType">Not selected</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Model:</span>
                            <span class="summary-value empty" id="summaryVehicleModel">Not provided</span>
                        </div>
                    </div>

                    <div class="summary-section">
                        <h4>Transport Details</h4>
                        <div class="summary-item">
                            <span class="summary-label">From:</span>
                            <span class="summary-value empty" id="summaryPickup">Not set</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">To:</span>
                            <span class="summary-value empty" id="summaryDrop">Not set</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Date:</span>
                            <span class="summary-value empty" id="summaryDate">Not selected</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Time:</span>
                            <span class="summary-value empty" id="summaryTime">Any time</span>
                        </div>
                    </div>

                    <!-- Delivery Estimate -->
                    <div class="delivery-estimate">
                        <div class="label">Estimated Delivery Date</div>
                        <div class="date" id="estimatedDelivery">Select pickup date</div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="summary-actions">
                        <button class="summary-btn btn-download" onclick="downloadPDF()">
                            <i class="fas fa-download"></i> Download PDF
                        </button>
                        <button class="summary-btn btn-print" onclick="printSummary()">
                            <i class="fas fa-print"></i> Print Summary
                        </button>
                    </div>
                </div>
            </div>

            <!-- Interactive Map Section -->
            <div class="map-section" style="margin-top: 40px;">
                <div class="map-container-wrapper fade-in">
                    <div class="map-header">
                        <h3>
                            <i class="fas fa-map-marked-alt"></i>
                            Interactive Location Map
                        </h3>
                        <p>View the route between selected cities or explore locations</p>
                    </div>
                    
                    <div id="map"></div>
                    
                    <div class="map-controls">
                        <button class="map-control-btn" id="clearRouteBtn" onclick="clearRoute()">
                            <i class="fas fa-trash"></i> Clear Route
                        </button>
                        <button class="map-control-btn" id="centerMapBtn" onclick="centerMap()">
                            <i class="fas fa-crosshairs"></i> Center Map
                        </button>
                        <button class="map-control-btn" id="showRouteBtn" onclick="showRoute()">
                            <i class="fas fa-route"></i> Show Route
                        </button>
                    </div>

                    <div class="route-info" id="routeInfo">
                        <h4><i class="fas fa-info-circle"></i> Route Information</h4>
                        <div class="route-details">
                            <div class="route-detail-item">
                                <label>Distance</label>
                                <span id="routeDistance">-- km</span>
                            </div>
                            <div class="route-detail-item">
                                <label>Estimated Time</label>
                                <span id="routeTime">-- hours</span>
                            </div>
                            <div class="route-detail-item">
                                <label>Estimated Cost</label>
                                <span id="routeCost">₹ --</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Success Modal -->
    <div class="modal" id="successModal">
        <div class="modal-content">
            <div class="confetti-container" id="confettiContainer"></div>
            
            <!-- Animated Checkmark SVG -->
            <svg class="success-animation" viewBox="0 0 52 52">
                <circle class="checkmark-circle" cx="26" cy="26" r="25" fill="none"/>
                <path class="checkmark-check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/>
            </svg>

            <h3>🎉 Booking Confirmed!</h3>
            <p>Thank you for choosing Harihar Car Carriers. Your booking has been successfully submitted.</p>
            
            <div class="booking-reference">
                <div class="label">Booking Reference Number</div>
                <div class="ref-number" id="bookingRef">HC2024-001</div>
            </div>

            <p style="font-size: 0.9rem; color: #999;">
                A confirmation email has been sent to your registered email address. 
                Our team will contact you within 24 hours.
            </p>

            <button class="modal-btn" onclick="closeModal()">
                <i class="fas fa-check"></i> Got It!
            </button>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>
    
    <!-- Leaflet Routing Machine -->
    <script src="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.js"></script>
    
    <!-- Leaflet Control Geocoder -->
    <script src="https://unpkg.com/leaflet-control-geocoder@2.4.0/dist/Control.Geocoder.js"></script>

    <script>
        // ========================================
        // GLOBAL VARIABLES
        // ========================================
        let map;
        let pickupMarker;
        let dropMarker;
        let routingControl;
        let pickupCoords = null;
        let dropCoords = null;
        let selectingPickup = false;
        let selectingDrop = false;
        let currentStep = 1;
        let formData = {};

        // ========================================
        // MULTI-STEP FORM MANAGEMENT
        // ========================================
        function nextStep() {
            if (!validateStep(currentStep)) {
                showToast('Validation Error', 'Please fill all required fields correctly', 'error', 3000);
                return;
            }

            if (currentStep < 3) {
                currentStep++;
                updateStepDisplay();
                updateProgressBar();
                if (currentStep === 3) {
                    populateReviewSummary();
                }
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                currentStep--;
                updateStepDisplay();
                updateProgressBar();
            }
        }

        function updateStepDisplay() {
            // Hide all steps
            document.querySelectorAll('.form-step').forEach(step => {
                step.classList.remove('active');
            });

            // Show current step
            document.querySelector(`.form-step[data-step="${currentStep}"]`).classList.add('active');

            // Update step indicators
            document.querySelectorAll('.step').forEach((step, index) => {
                const stepNum = index + 1;
                step.classList.remove('active', 'completed');
                
                if (stepNum < currentStep) {
                    step.classList.add('completed');
                } else if (stepNum === currentStep) {
                    step.classList.add('active');
                }
            });

            // Scroll to top of form
            document.querySelector('.booking-form-container').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function updateProgressBar() {
            const progress = ((currentStep - 1) / 2) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('progressPercentage').textContent = Math.round((currentStep / 3) * 100) + '% Complete';
        }

        function validateStep(step) {
            let isValid = true;

            if (step === 1) {
                // Validate personal and vehicle info
                const fields = ['fullName', 'phone', 'email', 'vehicleType'];
                fields.forEach(field => {
                    const input = document.getElementById(field);
                    if (!validateField(field, input.value)) {
                        isValid = false;
                    }
                });
            } else if (step === 2) {
                // Validate location and schedule
                const fields = ['pickupCity', 'dropCity', 'pickupDate'];
                fields.forEach(field => {
                    const input = document.getElementById(field);
                    if (!validateField(field, input.value)) {
                        isValid = false;
                    }
                });
            }

            return isValid;
        }

        function populateReviewSummary() {
            const reviewContent = document.getElementById('reviewContent');
            const formData = new FormData(document.getElementById('bookingForm'));
            
            let html = '<div style="display: grid; gap: 15px;">';
            
            // Personal Info
            html += '<div>';
            html += '<h5 style="color: #ff6347; margin-bottom: 10px;"><i class="fas fa-user"></i> Personal Information</h5>';
            html += `<p style="color: #ccc; margin: 5px 0;"><strong>Name:</strong> ${formData.get('fullName') || 'Not provided'}</p>`;
            html += `<p style="color: #ccc; margin: 5px 0;"><strong>Phone:</strong> ${formData.get('phone') || 'Not provided'}</p>`;
            html += `<p style="color: #ccc; margin: 5px 0;"><strong>Email:</strong> ${formData.get('email') || 'Not provided'}</p>`;
            html += '</div>';
            
            // Vehicle Info
            html += '<div>';
            html += '<h5 style="color: #ff6347; margin-bottom: 10px;"><i class="fas fa-car"></i> Vehicle Details</h5>';
            html += `<p style="color: #ccc; margin: 5px 0;"><strong>Type:</strong> ${formatVehicleType(formData.get('vehicleType'))}</p>`;
            html += `<p style="color: #ccc; margin: 5px 0;"><strong>Model:</strong> ${formData.get('vehicleModel') || 'Not specified'}</p>`;
            html += '</div>';
            
            // Transport Details
            html += '<div>';
            html += '<h5 style="color: #ff6347; margin-bottom: 10px;"><i class="fas fa-route"></i> Transport Details</h5>';
            const pickupCity = formData.get('pickupCity') || formData.get('pickupLocation') || 'Not set';
            const dropCity = formData.get('dropCity') || formData.get('dropLocation') || 'Not set';
            html += `<p style="color: #ccc; margin: 5px 0;"><strong>From:</strong> ${pickupCity}</p>`;
            html += `<p style="color: #ccc; margin: 5px 0;"><strong>To:</strong> ${dropCity}</p>`;
            html += `<p style="color: #ccc; margin: 5px 0;"><strong>Date:</strong> ${formatDate(formData.get('pickupDate'))}</p>`;
            html += `<p style="color: #ccc; margin: 5px 0;"><strong>Time:</strong> ${formatTime(formData.get('pickupTime'))}</p>`;
            html += '</div>';
            
            html += '</div>';
            reviewContent.innerHTML = html;
        }

        function formatVehicleType(type) {
            const types = {
                'hatchback': 'Hatchback',
                'sedan': 'Sedan',
                'suv': 'SUV',
                'luxury': 'Luxury Car',
                'bike': 'Motorcycle',
                'commercial': 'Commercial Vehicle'
            };
            return types[type] || type;
        }

        function formatDate(dateStr) {
            if (!dateStr) return 'Not selected';
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-IN', { day: 'numeric', month: 'long', year: 'numeric' });
        }

        function formatTime(time) {
            const times = {
                'any': 'Any Time',
                'morning': 'Morning (8 AM - 12 PM)',
                'afternoon': 'Afternoon (12 PM - 5 PM)',
                'evening': 'Evening (5 PM - 8 PM)'
            };
            return times[time] || 'Any Time';
        }

        // ========================================
        // REAL-TIME VALIDATION
        // ========================================
        function validateField(fieldName, value) {
            const validators = {
                fullName: (val) => val.trim().length >= 2,
                phone: (val) => /^[6-9]\d{9}$/.test(val.replace(/\D/g, '')),
                email: (val) => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(val),
                vehicleType: (val) => val.trim() !== '',
                pickupCity: (val) => val.trim() !== '',
                dropCity: (val) => val.trim() !== '',
                pickupLocation: (val) => val.trim() !== '',
                dropLocation: (val) => val.trim() !== '',
                pickupDate: (val) => val !== ''
            };

            const validator = validators[fieldName];
            if (!validator) return true;

            const isValid = validator(value);
            const input = document.getElementById(fieldName);
            const errorElement = document.getElementById(fieldName + 'Error');
            const formGroup = input.closest('.form-group');
            const validationIcon = formGroup.querySelector('.validation-icon');

            if (isValid) {
                input.classList.remove('error');
                formGroup.classList.add('valid');
                if (errorElement) errorElement.style.display = 'none';
                if (validationIcon) {
                    validationIcon.className = 'validation-icon success';
                }
            } else {
                input.classList.add('error');
                formGroup.classList.remove('valid');
                if (errorElement) {
                    errorElement.style.display = 'block';
                    errorElement.textContent = getErrorMessage(fieldName);
                }
                if (validationIcon) {
                    validationIcon.className = 'validation-icon error';
                }
                input.classList.add('shake');
                setTimeout(() => input.classList.remove('shake'), 500);
            }

            return isValid;
        }

        function getErrorMessage(field) {
            const messages = {
                fullName: 'Please enter your full name (min 2 characters)',
                phone: 'Please enter a valid 10-digit Indian phone number',
                email: 'Please enter a valid email address',
                vehicleType: 'Please select vehicle type',
                pickupCity: 'Please select pickup city',
                dropCity: 'Please select drop city',
                pickupLocation: 'Please enter pickup location',
                dropLocation: 'Please enter drop location',
                pickupDate: 'Please select pickup date'
            };
            return messages[field] || 'This field is required';
        }

        // ========================================
        // BOOKING SUMMARY LIVE UPDATE
        // ========================================
        function updateBookingSummary() {
            const formData = new FormData(document.getElementById('bookingForm'));
            
            // Update personal info
            updateSummaryField('summaryName', formData.get('fullName'));
            updateSummaryField('summaryPhone', formData.get('phone'));
            updateSummaryField('summaryEmail', formData.get('email'));
            
            // Update vehicle details
            updateSummaryField('summaryVehicleType', formatVehicleType(formData.get('vehicleType')));
            updateSummaryField('summaryVehicleModel', formData.get('vehicleModel') || 'Not provided');
            
            // Update transport details (use city names primarily)
            const pickupCity = formData.get('pickupCity') || formData.get('pickupLocation');
            const dropCity = formData.get('dropCity') || formData.get('dropLocation');
            updateSummaryField('summaryPickup', pickupCity, 'Not set');
            updateSummaryField('summaryDrop', dropCity, 'Not set');
            updateSummaryField('summaryDate', formatDate(formData.get('pickupDate')), 'Not selected');
            updateSummaryField('summaryTime', formatTime(formData.get('pickupTime')));
            
            // Update delivery estimate
            if (formData.get('pickupDate')) {
                const pickupDate = new Date(formData.get('pickupDate'));
                const deliveryDate = new Date(pickupDate);
                const distance = parseFloat(document.getElementById('distanceSlider').value);
                const days = Math.ceil(distance / 400) + 1; // Approx 400km per day
                deliveryDate.setDate(deliveryDate.getDate() + days);
                
                document.getElementById('estimatedDelivery').textContent = 
                    deliveryDate.toLocaleDateString('en-IN', { day: 'numeric', month: 'long', year: 'numeric' });
            }
        }

        function updateSummaryField(elementId, value, defaultText = 'Not provided') {
            const element = document.getElementById(elementId);
            if (value && value.trim() !== '') {
                element.textContent = value;
                element.classList.remove('empty');
            } else {
                element.textContent = defaultText;
                element.classList.add('empty');
            }
        }

        // ========================================
        // PRICE CALCULATOR
        // ========================================
        function updatePriceCalculation() {
            const distance = parseFloat(document.getElementById('distanceSlider').value);
            const vehicleType = document.getElementById('vehicleType').value;
            
            // Base fare based on vehicle type
            const baseFares = {
                'hatchback': 2000,
                'sedan': 2500,
                'suv': 3500,
                'luxury': 5000,
                'bike': 1500,
                'commercial': 4000
            };
            
            const baseFare = baseFares[vehicleType] || 2000;
            const distanceCharge = distance * 15; // ₹15 per km
            const subtotal = baseFare + distanceCharge;
            const gst = subtotal * 0.18;
            let total = subtotal + gst;
            
            // Apply discount for first booking (10%)
            const isFirstBooking = true; // This would be determined by user session/database
            if (isFirstBooking && distance > 0) {
                total = total * 0.9;
                document.getElementById('discountBadge').style.display = 'block';
            } else {
                document.getElementById('discountBadge').style.display = 'none';
            }
            
            // Update display with animation
            animateValue('baseFare', baseFare);
            animateValue('distanceCharge', distanceCharge);
            animateValue('gst', gst);
            animateValue('totalPrice', total);
            
            document.getElementById('distanceValue').textContent = distance + ' km';
        }

        function animateValue(elementId, endValue) {
            const element = document.getElementById(elementId);
            const startValue = parseFloat(element.textContent.replace(/[₹,]/g, '')) || 0;
            const duration = 500;
            const startTime = performance.now();
            
            function update(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                const currentValue = startValue + (endValue - startValue) * progress;
                element.textContent = '₹ ' + Math.round(currentValue).toLocaleString('en-IN');
                
                if (progress < 1) {
                    requestAnimationFrame(update);
                }
            }
            
            requestAnimationFrame(update);
        }

        // ========================================
        // CONFETTI ANIMATION
        // ========================================
        function createConfetti() {
            const container = document.getElementById('confettiContainer');
            const colors = ['#ff6347', '#4CAF50', '#2196F3', '#FFC107', '#9C27B0', '#FF9800'];
            
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = Math.random() * 2 + 's';
                confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
                container.appendChild(confetti);
                
                setTimeout(() => {
                    if (confetti.parentNode) {
                        confetti.parentNode.removeChild(confetti);
                    }
                }, 4000);
            }
        }

        // ========================================
        // PDF & PRINT FUNCTIONS
        // ========================================
        function downloadPDF() {
            showToast('Download', 'PDF generation feature coming soon!', 'info', 3000);
            // This would integrate with a PDF library like jsPDF
        }

        function printSummary() {
            window.print();
        }

        // ========================================
        // CHARACTER COUNTER
        // ========================================
        function updateCharacterCount() {
            const textarea = document.getElementById('additionalInfo');
            const counter = document.getElementById('charCount');
            const count = textarea.value.length;
            const maxLength = 500;
            
            counter.textContent = count;
            counter.parentElement.classList.remove('warning', 'danger');
            
            if (count > maxLength * 0.9) {
                counter.parentElement.classList.add('danger');
            } else if (count > maxLength * 0.7) {
                counter.parentElement.classList.add('warning');
            }
        }

        // ========================================
        // MAP FUNCTIONS
        // ========================================
        // Indian Cities Database for Autocomplete
        const indianCities = [
            'Mumbai', 'Delhi', 'Bangalore', 'Hyderabad', 'Ahmedabad', 'Chennai', 'Kolkata',
            'Pune', 'Jaipur', 'Surat', 'Lucknow', 'Kanpur', 'Nagpur', 'Indore', 'Thane',
            'Bhopal', 'Visakhapatnam', 'Pimpri-Chinchwad', 'Patna', 'Vadodara', 'Ghaziabad',
            'Ludhiana', 'Agra', 'Nashik', 'Faridabad', 'Meerut', 'Rajkot', 'Kalyan-Dombivali',
            'Vasai-Virar', 'Varanasi', 'Srinagar', 'Aurangabad', 'Dhanbad', 'Amritsar',
            'Navi Mumbai', 'Allahabad', 'Ranchi', 'Howrah', 'Coimbatore', 'Jabalpur',
            'Gwalior', 'Vijayawada', 'Jodhpur', 'Madurai', 'Raipur', 'Kota', 'Chandigarh',
            'Guwahati', 'Solapur', 'Hubli-Dharwad', 'Mysore', 'Tiruchirappalli', 'Bareilly',
            'Moradabad', 'Mysuru', 'Gurgaon', 'Aligarh', 'Jalandhar', 'Bhubaneswar',
            'Salem', 'Mira-Bhayandar', 'Warangal', 'Guntur', 'Bhiwandi', 'Saharanpur',
            'Gorakhpur', 'Bikaner', 'Amravati', 'Noida', 'Jamshedpur', 'Bhilai', 'Cuttack',
            'Firozabad', 'Kochi', 'Nellore', 'Bhavnagar', 'Dehradun', 'Durgapur', 'Asansol',
            'Siliguri', 'Rourkela', 'Mangalore', 'Tiruppur', 'Belgaum', 'Ujjain', 'Jamnagar'
        ];

        let selectedPickupCity = '';
        let selectedDropCity = '';

        // Setup autocomplete for city inputs
        function setupCityAutocomplete() {
            const pickupInput = document.getElementById('pickupCity');
            const dropInput = document.getElementById('dropCity');

            if (pickupInput) {
                setupAutocomplete(pickupInput, 'pickupCityDropdown', (city) => {
                    selectedPickupCity = city;
                    document.getElementById('pickupLocation').value = city + ', India';
                    updateBookingSummary();
                    if (selectedDropCity) {
                        calculateRouteForCities();
                    }
                });
            }

            if (dropInput) {
                setupAutocomplete(dropInput, 'dropCityDropdown', (city) => {
                    selectedDropCity = city;
                    document.getElementById('dropLocation').value = city + ', India';
                    updateBookingSummary();
                    if (selectedPickupCity) {
                        calculateRouteForCities();
                    }
                });
            }
        }

        function setupAutocomplete(inputElement, dropdownId, onSelectCallback) {
            const dropdown = document.getElementById(dropdownId);
            let currentFocus = -1;

            inputElement.addEventListener('input', function() {
                const value = this.value.trim();
                dropdown.innerHTML = '';
                currentFocus = -1;

                if (!value) {
                    dropdown.classList.remove('show');
                    return;
                }

                const matches = indianCities.filter(city => 
                    city.toLowerCase().includes(value.toLowerCase())
                ).slice(0, 8);

                if (matches.length === 0) {
                    dropdown.classList.remove('show');
                    return;
                }

                matches.forEach((city, index) => {
                    const item = document.createElement('div');
                    item.className = 'autocomplete-item';
                    
                    const regex = new RegExp(`(${value})`, 'gi');
                    const highlightedText = city.replace(regex, '<strong>$1</strong>');
                    item.innerHTML = highlightedText;
                    
                    item.addEventListener('click', function() {
                        inputElement.value = city;
                        dropdown.classList.remove('show');
                        if (onSelectCallback) {
                            onSelectCallback(city);
                        }
                    });
                    
                    dropdown.appendChild(item);
                });

                dropdown.classList.add('show');
            });

            inputElement.addEventListener('keydown', function(e) {
                const items = dropdown.getElementsByClassName('autocomplete-item');
                
                if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    currentFocus++;
                    if (currentFocus >= items.length) currentFocus = 0;
                    setActive(items);
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    currentFocus--;
                    if (currentFocus < 0) currentFocus = items.length - 1;
                    setActive(items);
                } else if (e.key === 'Enter') {
                    e.preventDefault();
                    if (currentFocus > -1 && items[currentFocus]) {
                        items[currentFocus].click();
                    }
                } else if (e.key === 'Escape') {
                    dropdown.classList.remove('show');
                }
            });

            function setActive(items) {
                Array.from(items).forEach((item, index) => {
                    item.classList.remove('active');
                    if (index === currentFocus) {
                        item.classList.add('active');
                        item.scrollIntoView({ block: 'nearest' });
                    }
                });
            }

            // Close dropdown when clicking outside
            document.addEventListener('click', function(e) {
                if (e.target !== inputElement) {
                    dropdown.classList.remove('show');
                }
            });
        }

        function calculateRouteForCities() {
            if (!selectedPickupCity || !selectedDropCity) return;

            // Geocode both cities and show route
            geocodeCity(selectedPickupCity, (pickupLatLng) => {
                geocodeCity(selectedDropCity, (dropLatLng) => {
                    if (pickupLatLng && dropLatLng) {
                        pickupCoords = pickupLatLng;
                        dropCoords = dropLatLng;
                        setPickupLocation(pickupLatLng[0], pickupLatLng[1], selectedPickupCity + ', India');
                        setDropLocation(dropLatLng[0], dropLatLng[1], selectedDropCity + ', India');
                        
                        // Estimate distance between cities and update slider
                        const distance = estimateDistance(pickupLatLng, dropLatLng);
                        const distanceSlider = document.getElementById('distanceSlider');
                        if (distanceSlider) {
                            distanceSlider.value = Math.round(distance);
                            updatePriceCalculation();
                        }
                    }
                });
            });
        }
        
        function estimateDistance(coord1, coord2) {
            // Haversine formula to calculate distance between two coordinates
            const R = 6371; // Radius of Earth in km
            const dLat = (coord2[0] - coord1[0]) * Math.PI / 180;
            const dLon = (coord2[1] - coord1[1]) * Math.PI / 180;
            const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                      Math.cos(coord1[0] * Math.PI / 180) * Math.cos(coord2[0] * Math.PI / 180) *
                      Math.sin(dLon/2) * Math.sin(dLon/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            return R * c;
        }

        function geocodeCity(cityName, callback) {
            fetch(`https://nominatim.openstreetmap.org/search?city=${encodeURIComponent(cityName)}&country=India&format=json&limit=1`)
                .then(response => response.json())
                .then(data => {
                    if (data && data.length > 0) {
                        callback([parseFloat(data[0].lat), parseFloat(data[0].lon)]);
                    } else {
                        callback(null);
                    }
                })
                .catch(error => {
                    console.error('Geocoding error:', error);
                    callback(null);
                });
        }

        function initMap() {
            // Create map centered on India
            map = L.map('map').setView([20.5937, 78.9629], 5);

            // Add OpenStreetMap tiles
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
                maxZoom: 19
            }).addTo(map);

            // Add geocoder (search) control
            const geocoder = L.Control.geocoder({
                defaultMarkGeocode: false,
                placeholder: 'Search location...',
                errorMessage: 'Location not found'
            })
            .on('markgeocode', function(e) {
                const latlng = e.geocode.center;
                map.setView(latlng, 13);
                
                if (selectingPickup) {
                    setPickupLocation(latlng.lat, latlng.lng, e.geocode.name);
                } else if (selectingDrop) {
                    setDropLocation(latlng.lat, latlng.lng, e.geocode.name);
                }
            })
            .addTo(map);

            // Add click event to map
            map.on('click', function(e) {
                if (selectingPickup) {
                    reverseGeocode(e.latlng.lat, e.latlng.lng, 'pickup');
                } else if (selectingDrop) {
                    reverseGeocode(e.latlng.lat, e.latlng.lng, 'drop');
                }
            });

            // Custom markers
            const pickupIcon = L.divIcon({
                html: '<i class="fas fa-map-marker-alt" style="color: #4CAF50; font-size: 32px;"></i>',
                className: 'custom-div-icon',
                iconSize: [32, 32],
                iconAnchor: [16, 32]
            });

            const dropIcon = L.divIcon({
                html: '<i class="fas fa-flag-checkered" style="color: #ff6347; font-size: 32px;"></i>',
                className: 'custom-div-icon',
                iconSize: [32, 32],
                iconAnchor: [16, 32]
            });
        }

        // Reverse geocoding
        function reverseGeocode(lat, lng, type) {
            fetch(`https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lng}&format=json`)
                .then(response => response.json())
                .then(data => {
                    const address = data.display_name;
                    if (type === 'pickup') {
                        setPickupLocation(lat, lng, address);
                    } else if (type === 'drop') {
                        setDropLocation(lat, lng, address);
                    }
                })
                .catch(error => {
                    console.error('Geocoding error:', error);
                    showToast('Error', 'Could not get address for this location', 'error', 3000);
                });
        }

        // Set pickup location
        function setPickupLocation(lat, lng, address) {
            pickupCoords = [lat, lng];
            
            if (pickupMarker) {
                map.removeLayer(pickupMarker);
            }

            const pickupIcon = L.divIcon({
                html: '<i class="fas fa-map-marker-alt" style="color: #4CAF50; font-size: 32px;"></i>',
                className: 'custom-div-icon',
                iconSize: [32, 32],
                iconAnchor: [16, 32]
            });

            pickupMarker = L.marker([lat, lng], {
                icon: pickupIcon,
                draggable: true
            }).addTo(map);

            pickupMarker.bindPopup('<b>Pickup Location</b><br>' + address).openPopup();
            
            pickupMarker.on('dragend', function(e) {
                const newPos = e.target.getLatLng();
                reverseGeocode(newPos.lat, newPos.lng, 'pickup');
            });

            document.getElementById('pickupLocation').value = address;
            selectingPickup = false;
            
            showToast('Success', 'Pickup location set!', 'success', 2000);
            
            if (dropCoords) {
                calculateRoute();
            }
        }

        // Set drop location
        function setDropLocation(lat, lng, address) {
            dropCoords = [lat, lng];
            
            if (dropMarker) {
                map.removeLayer(dropMarker);
            }

            const dropIcon = L.divIcon({
                html: '<i class="fas fa-flag-checkered" style="color: #ff6347; font-size: 32px;"></i>',
                className: 'custom-div-icon',
                iconSize: [32, 32],
                iconAnchor: [16, 32]
            });

            dropMarker = L.marker([lat, lng], {
                icon: dropIcon,
                draggable: true
            }).addTo(map);

            dropMarker.bindPopup('<b>Drop Location</b><br>' + address).openPopup();
            
            dropMarker.on('dragend', function(e) {
                const newPos = e.target.getLatLng();
                reverseGeocode(newPos.lat, newPos.lng, 'drop');
            });

            document.getElementById('dropLocation').value = address;
            selectingDrop = false;
            
            showToast('Success', 'Drop location set!', 'success', 2000);
            
            if (pickupCoords) {
                calculateRoute();
            }
        }

        // Select pickup on map
        function selectPickupOnMap() {
            selectingPickup = true;
            selectingDrop = false;
            showToast('Info', 'Click on the map to select pickup location', 'info', 3000);
        }

        // Select drop on map
        function selectDropOnMap() {
            selectingDrop = true;
            selectingPickup = false;
            showToast('Info', 'Click on the map to select drop location', 'info', 3000);
        }

        // Calculate and show route
        function calculateRoute() {
            if (!pickupCoords || !dropCoords) {
                showToast('Warning', 'Please select both pickup and drop locations', 'warning', 3000);
                return;
            }

            if (routingControl) {
                map.removeControl(routingControl);
            }

            routingControl = L.Routing.control({
                waypoints: [
                    L.latLng(pickupCoords[0], pickupCoords[1]),
                    L.latLng(dropCoords[0], dropCoords[1])
                ],
                routeWhileDragging: false,
                showAlternatives: false,
                lineOptions: {
                    styles: [{color: '#ff6347', opacity: 0.8, weight: 5}]
                },
                createMarker: function() { return null; }, // Don't create default markers
                addWaypoints: false
            }).addTo(map);

            routingControl.on('routesfound', function(e) {
                const route = e.routes[0];
                const distance = (route.summary.totalDistance / 1000).toFixed(2);
                const time = (route.summary.totalTime / 3600).toFixed(1);
                const cost = Math.round(distance * 15); // ₹15 per km estimate

                document.getElementById('routeDistance').textContent = distance + ' km';
                document.getElementById('routeTime').textContent = time + ' hours';
                document.getElementById('routeCost').textContent = '₹ ' + cost.toLocaleString();
                
                document.getElementById('routeInfo').classList.add('show');
                
                showToast('Route Found', `Distance: ${distance}km, Time: ${time}hrs`, 'success', 4000);
            });

            // Fit bounds to show entire route
            const bounds = L.latLngBounds([pickupCoords, dropCoords]);
            map.fitBounds(bounds, { padding: [50, 50] });
        }

        // Show route
        function showRoute() {
            calculateRoute();
        }

        // Clear route
        function clearRoute() {
            if (routingControl) {
                map.removeControl(routingControl);
                routingControl = null;
            }
            
            if (pickupMarker) {
                map.removeLayer(pickupMarker);
                pickupMarker = null;
            }
            
            if (dropMarker) {
                map.removeLayer(dropMarker);
                dropMarker = null;
            }
            
            pickupCoords = null;
            dropCoords = null;
            
            document.getElementById('pickupLocation').value = '';
            document.getElementById('dropLocation').value = '';
            document.getElementById('routeInfo').classList.remove('show');
            
            showToast('Cleared', 'Route and markers cleared', 'info', 2000);
        }

        // Center map
        function centerMap() {
            if (pickupCoords && dropCoords) {
                const bounds = L.latLngBounds([pickupCoords, dropCoords]);
                map.fitBounds(bounds, { padding: [50, 50] });
            } else {
                map.setView([20.5937, 78.9629], 5);
            }
        }

        // Toast Notification System
        function showToast(title, message, type = 'success', duration = 5000) {
            const toastContainer = document.getElementById('toastContainer');
            const toastId = 'toast-' + Date.now();

            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.id = toastId;

            let icon = 'fa-check-circle';
            if (type === 'error') icon = 'fa-exclamation-circle';
            if (type === 'warning') icon = 'fa-exclamation-triangle';
            if (type === 'info') icon = 'fa-info-circle';

            toast.innerHTML = `
                <div class="toast-icon">
                    <i class="fas ${icon}"></i>
                </div>
                <div class="toast-content">
                    <div class="toast-title">${title}</div>
                    <div class="toast-message">${message}</div>
                </div>
                <button class="toast-close" onclick="removeToast('${toastId}')">
                    <i class="fas fa-times"></i>
                </button>
            `;

            toastContainer.appendChild(toast);

            setTimeout(() => {
                toast.classList.add('show');
            }, 10);

            if (duration > 0) {
                setTimeout(() => {
                    removeToast(toastId);
                }, duration);
            }

            return toastId;
        }

        function removeToast(toastId) {
            const toast = document.getElementById(toastId);
            if (toast) {
                toast.classList.remove('show');
                toast.classList.add('hide');

                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.parentNode.removeChild(toast);
                    }
                }, 300);
            }
        }

        // ========================================
        // DOM CONTENT LOADED - INITIALIZATION
        // ========================================
        document.addEventListener('DOMContentLoaded', function () {
            // Initialize map first
            initMap();

            // Setup city autocomplete
            setupCityAutocomplete();

            // Initialize BookingManager (if using modular approach)
            // window.bookingManager = new BookingManager();

            const bookingForm = document.getElementById('bookingForm');
            const submitBtn = document.getElementById('submitBtn');
            const successModal = document.getElementById('successModal');
            const bookingRef = document.getElementById('bookingRef');

            // Initialize date input minimum value
            const dateInput = document.getElementById('pickupDate');
            const today = new Date().toISOString().split('T')[0];
            dateInput.min = today;

            // Add input event listeners for real-time validation
            const validationFields = ['fullName', 'phone', 'email', 'vehicleType', 'pickupCity', 'dropCity', 'pickupDate'];
            
            validationFields.forEach(field => {
                const input = document.getElementById(field);
                if (input) {
                    input.addEventListener('input', function() {
                        validateField(field, this.value);
                        updateBookingSummary();
                    });
                    
                    input.addEventListener('blur', function() {
                        validateField(field, this.value);
                    });
                }
            });

            // Character counter for textarea
            const additionalInfo = document.getElementById('additionalInfo');
            additionalInfo.addEventListener('input', updateCharacterCount);

            // Phone number formatting
            const phoneInput = document.getElementById('phone');
            phoneInput.addEventListener('input', function (e) {
                let value = e.target.value.replace(/\D/g, '');
                if (value.length > 0) {
                    value = value.substring(0, 10);
                    if (value.length > 5) {
                        value = value.substring(0, 5) + ' ' + value.substring(5);
                    }
                }
                e.target.value = value;
            });

            // Vehicle type change - update pricing
            document.getElementById('vehicleType').addEventListener('change', function() {
                updatePriceCalculation();
                updateBookingSummary();
            });

            // Distance slider - initialize with estimated distance if cities selected
            const distanceSlider = document.getElementById('distanceSlider');
            distanceSlider.addEventListener('input', function() {
                updatePriceCalculation();
                updateBookingSummary();
            });
            
            // Initialize price calculation on load
            updatePriceCalculation();

            // Pickup date change
            document.getElementById('pickupDate').addEventListener('change', function() {
                updateBookingSummary();
            });

            // Pickup time change
            document.getElementById('pickupTime').addEventListener('change', function() {
                updateBookingSummary();
            });

            // Form submission
            bookingForm.addEventListener('submit', function (e) {
                e.preventDefault();

                if (!validateStep(3)) {
                    showToast('Validation Error', 'Please check all fields', 'error', 3000);
                    return;
                }

                submitBtn.disabled = true;
                submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i><span>Processing...</span>';

                // Simulate API call
                setTimeout(() => {
                    const reference = generateBookingRef();
                    bookingRef.textContent = reference;

                    // Create confetti
                    createConfetti();

                    // Show success modal
                    successModal.style.display = 'flex';

                    // Reset form
                    bookingForm.reset();
                    currentStep = 1;
                    updateStepDisplay();
                    updateProgressBar();
                    clearRoute();
                    updateBookingSummary();

                    // Re-enable submit button
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = '<i class="fas fa-paper-plane"></i><span>Confirm Booking</span>';

                    showToast(
                        'Booking Confirmed!',
                        `Your booking reference is ${reference}`,
                        'success',
                        5000
                    );
                }, 2000);
            });

            function generateBookingRef() {
                const prefix = 'HC';
                const year = new Date().getFullYear();
                const randomNum = Math.floor(Math.random() * 10000).toString().padStart(4, '0');
                return `${prefix}${year}-${randomNum}`;
            }
        });

        // ========================================
        // MODAL FUNCTIONS
        // ========================================
        function closeModal() {
            document.getElementById('successModal').style.display = 'none';
        }

        window.addEventListener('click', function (e) {
            const modal = document.getElementById('successModal');
            if (e.target === modal) {
                closeModal();
            }
        });
    </script>
</body>

</html>